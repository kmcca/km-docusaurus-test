"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[93382],{21843:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var t=r(85893),n=r(11151);const i={title:"Enable security headers",slug:"/r/enable-security-headers"},c=void 0,d={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/enable-security-headers",title:"Enable security headers",description:"Security headers can effectively prevent a variety of hacking attempts. Therefore, you should consider Strict-Transport-Security, Content-Security-Policy, X-Frame-Options, or X-XSS-Protection titles.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/18_enable-security-headers.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/enable-security-headers",permalink:"/km-docusaurus-test/r/enable-security-headers",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:18,frontMatter:{title:"Enable security headers",slug:"/r/enable-security-headers"},sidebar:"tutorialSidebar",previous:{title:"Manage TLS warnings",permalink:"/km-docusaurus-test/r/manage-tls-warning"},next:{title:"Disable RC4",permalink:"/km-docusaurus-test/r/disable-ssl-rc4"}},o={},l=[{value:"Security Assessment",id:"security-assessment",level:2},{value:"What are Security headers?",id:"what-are-security-headers",level:3},{value:"How security headers can prevent vulnerabilities",id:"how-security-headers-can-prevent-vulnerabilities",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Webserver configuration",id:"webserver-configuration",level:3},{value:"Apache",id:"apache",level:3},{value:"Nginx",id:"nginx",level:3},{value:"HTTP Strict Transport Security (HSTS)",id:"http-strict-transport-security-hsts",level:3},{value:"X-Frame-Options",id:"x-frame-options",level:3},{value:"X-XXS-Protection",id:"x-xxs-protection",level:3},{value:"X-Content-Type-Options",id:"x-content-type-options",level:3},{value:"<code>Same-Site Cookie</code>",id:"same-site-cookie",level:3},{value:"<code>Content-Security-Policy</code>",id:"content-security-policy",level:3},{value:"<code>Referrer-Policy</code>",id:"referrer-policy",level:3},{value:"<code>Cache-Control</code>",id:"cache-control",level:3},{value:"<code>Access-Control-Allow-Origin</code>",id:"access-control-allow-origin",level:3}];function a(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"Security headers can effectively prevent a variety of hacking attempts. Therefore, you should consider Strict-Transport-Security, Content-Security-Policy, X-Frame-Options, or X-XSS-Protection titles."}),"\n",(0,t.jsx)(s.h2,{id:"security-assessment",children:"Security Assessment"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Security_Assessment_EnableSecurityHeaders",src:r(34033).Z+"",width:"907",height:"332"})}),"\n",(0,t.jsxs)(s.p,{children:["CVSS vector: ",(0,t.jsxs)(s.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":L","/I",":L","/A",":N"]})]}),"\n",(0,t.jsx)(s.h3,{id:"what-are-security-headers",children:"What are Security headers?"}),"\n",(0,t.jsx)(s.p,{children:"They are directives to increase the protection and create more defense against vulnerabilities using browsers. For example, they modify the behavior of web browsers to avoid security vulnerabilities just to accept one kind of valid server certificate like TLS."}),"\n",(0,t.jsx)(s.p,{children:"Types of security headers include:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/enable-hsts",children:"HTTP Strict Transport Security (HSTS)"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/content-security-policy",children:"Content Security Policy (CSP)"})}),"\n",(0,t.jsx)(s.li,{children:"HTTP Public Key Pinning (HPKP)"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"how-security-headers-can-prevent-vulnerabilities",children:"How security headers can prevent vulnerabilities"}),"\n",(0,t.jsx)(s.p,{children:"Inserting a security header can prevent a variety of hacking attempts."}),"\n",(0,t.jsx)(s.p,{children:"See the OWASP Secure Headers Project for the top HTTP response headers that provide security and usability."}),"\n",(0,t.jsx)(s.p,{children:"Here are some of the vulnerabilities you can avoid by using a security header:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Protocol downgrade attacks likePoodle"}),"\n",(0,t.jsx)(s.li,{children:"Content Injection attacks like XSS and Clickjacking"}),"\n",(0,t.jsx)(s.li,{children:"ReflectiveXSS attack"}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/cross-site-request-forgery",children:"Cross-Site Request Forgery attack"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/cross-site-scripting",children:"Cross-Site Scripting attack"})}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Before you apply a security-related HTTP response header for attack prevention, check whether it is compatible with the browsers you're targeting."}),"\n",(0,t.jsx)(s.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,t.jsx)(s.p,{children:"Use the following options to set the correct security headers for your web application:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Webserver Configuration (Apache, NGINX)"}),"\n",(0,t.jsx)(s.li,{children:"HTTP Strict Transport Security (HSTS)"}),"\n",(0,t.jsx)(s.li,{children:"X-Frame-Options"}),"\n",(0,t.jsx)(s.li,{children:"X-XXS-Protection"}),"\n",(0,t.jsx)(s.li,{children:"X-Content-Type-Options"}),"\n",(0,t.jsx)(s.li,{children:"Same-Site Cookie"}),"\n",(0,t.jsx)(s.li,{children:"Content-Security-Policy"}),"\n",(0,t.jsx)(s.li,{children:"Referrer-Policy"}),"\n",(0,t.jsx)(s.li,{children:"Access-Control-Allow-Origin"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"webserver-configuration",children:"Webserver configuration"}),"\n",(0,t.jsx)(s.p,{children:"Use the following configurations to configure your webserver to contain all described headers. Below, you find further descriptions of the single headers."}),"\n",(0,t.jsx)(s.h3,{id:"apache",children:"Apache"}),"\n",(0,t.jsxs)(s.p,{children:["On Apache you need to update your configuration to include the correct header directives. Add this to the virtual host configuration in ",(0,t.jsx)(s.code,{children:"/etc/apache2/sites-enabled/domain.conf"})," or ",(0,t.jsx)(s.code,{children:"/etc/httpd/sites-enabled/domain.conf"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'<VirtualHost *:443>  \n    Header always set Strict-Transport-Security "max-age=31536000"  \n    Header always set X-Frame-Options "deny"  \n    Header always set X-XSS-Protection "1; mode=block"  \n    Header always set X-Content-Type-Options "nosniff"  \n    Header always set Content-Security-Policy "default-src \'self\'"  \n    Header always set Referrer-Policy "strict-origin-when-cross-origin"  \n</VirtualHost>\n'})}),"\n",(0,t.jsx)(s.h3,{id:"nginx",children:"Nginx"}),"\n",(0,t.jsxs)(s.p,{children:["On Nginx you need to update your configuration file which is usually located at ",(0,t.jsx)(s.code,{children:"/etc/nginx/nginx.conf,/etc/nginx/sited-enabled/yoursite.com"})," (Ubuntu/Debian) or ",(0,t.jsx)(s.code,{children:"/etc/nginx/conf.d/nginx.conf"})," (RHEL/CentOS) to include the correct header with the ",(0,t.jsx)(s.code,{children:"add_header"})," directives:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'server {  \n    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains;" always;  \n    add_header X-Frame-Options "deny" always;  \n    add_header X-XSS-Protection "1; mode=block" always;  \n    add_header X-Content-Type-Options "nosniff" always;  \n    add_header Content-Security-Policy "default-src \'self\'" always;  \n    add_header Referrer-Policy "strict-origin-when-cross-origin" always;  \n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"http-strict-transport-security-hsts",children:"HTTP Strict Transport Security (HSTS)"}),"\n",(0,t.jsxs)(s.p,{children:["The HSTS header enforces HTTPS connections. This prevents downgrade attacks to an insecure HTTP connection. See ",(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/enable-hsts",children:"Enable HSTS"})," for the correct settings."]}),"\n",(0,t.jsx)(s.h3,{id:"x-frame-options",children:"X-Frame-Options"}),"\n",(0,t.jsx)(s.p,{children:"The X-Frame-Options header declares whether this site may be embedded as a frame into other websites. The values are:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"deny"})}),(0,t.jsx)(s.td,{children:"Do not allow frames of this site"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"same-origin"})}),(0,t.jsx)(s.td,{children:"Allow frames of this site when the domain matches"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"allow-from DOMAIN"})}),(0,t.jsx)(s.td,{children:"Allow frames of this site when embedded in webpages on DOMAIN"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"Setting this header, e.g., to deny, will protect the website against clickjacking attacks where an attacker overlays your iframe in your webpage with arbitrary content to bait his victims in clicking on certain links on your website."}),"\n",(0,t.jsx)(s.h3,{id:"x-xxs-protection",children:"X-XXS-Protection"}),"\n",(0,t.jsxs)(s.p,{children:["Some web browsers are shipped with a ",(0,t.jsx)(s.a,{href:"/km-docusaurus-test/r/cross-site-scripting",children:"Cross-Site-Scripting (XSS)"})," filter. This filter can ",(0,t.jsx)(s.a,{href:"https://crashtest-security.com/cross-site-scripting-xss/",children:"detect specific XSS attacks and prevent them"}),". To configure the browser filter behavior, use the X-XSS-Protection header."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"0"})}),(0,t.jsx)(s.td,{children:"Disable the filter"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"1"})}),(0,t.jsx)(s.td,{children:"Enable the filter to sanitize the webpage in case of an attack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"1; mode=block"})}),(0,t.jsx)(s.td,{children:"Enable the filter to block the webpage in case of an attack"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"Setting this header, e.g., to 1; mode=block will tell the browser that it should not render the web page if it detects an attack."}),"\n",(0,t.jsx)(s.h3,{id:"x-content-type-options",children:"X-Content-Type-Options"}),"\n",(0,t.jsxs)(s.p,{children:["Browsers try to detect the MIME-type of files sent by the webserver. For example, suppose an attacker manages to upload a malicious (executable) file to a webserver, which only sends images. The MIME-type can provide protection, as it tells the browser that it should expect an image and not an executable file. Therefore, the browser must not detect the MIME-type but only use the webserver provided MIME-type. To enforce this behavior, use the X-Content-Type-Options header and set it to ",(0,t.jsx)(s.code,{children:"nosniff"}),"."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"nosniff"})}),(0,t.jsx)(s.td,{children:"Only use the declared MIME-type"})]})})]}),"\n",(0,t.jsx)(s.h3,{id:"same-site-cookie",children:(0,t.jsx)(s.code,{children:"Same-Site Cookie"})}),"\n",(0,t.jsxs)(s.p,{children:["The Same-Site cookie flag tells the browser not to send cookies and cross-site requests. This cookie flag prevents the risk of cross-site information leakage and can also help to mitigate Cross-Site Request Forgery attacks. Possible values are ",(0,t.jsx)(s.code,{children:"Strict"}),", ",(0,t.jsx)(s.code,{children:"Lax"}),", or ",(0,t.jsx)(s.code,{children:"None"}),". If the ",(0,t.jsx)(s.code,{children:"Same-Site Cookie"})," flag is set to ",(0,t.jsx)(s.code,{children:"None"}),", the ",(0,t.jsx)(s.code,{children:"Secure"})," flag must be set to prevent sending the cookie in an insecure context."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"None"}),(0,t.jsx)(s.td,{children:"The cookie will be sent in all contexts."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Lax"}),(0,t.jsx)(s.td,{children:"The cookie is sent when a user follows a link to your site. But, the cookie is not sent when the site content is included in a third-party site."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Strict"}),(0,t.jsx)(s.td,{children:"Prevent the cookie from being sent to the target site in all cross-site requests, even when following a link into your site."})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"content-security-policy",children:(0,t.jsx)(s.code,{children:"Content-Security-Policy"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"Content-Security-Policy"})," (CSP) header tells the browser from which domain further resources such as scripts, images, or stylesheets may be loaded. This can prevent various Cross-Site-Scripting (XSS) and other Cross-Site-Injection attacks. However, the policy needs to be hand-crafted for the particular usage, as it may easily prohibit analytic scripts, fonts, or other resources that are loaded from a third party."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"default-scr 'self' resources.example.org"})}),(0,t.jsxs)(s.td,{children:["Define loading all resource types from the own domain and ",(0,t.jsx)(s.code,{children:"resources.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"script-src 'self' scripts.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable loading scripts from the own domain and ",(0,t.jsx)(s.code,{children:"scripts.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"object-src 'none'"})}),(0,t.jsxs)(s.td,{children:["Disallow loading of all objects such as ",(0,t.jsx)(s.code,{children:"<applet>"}),", ",(0,t.jsx)(s.code,{children:"<embed>"}),", and ",(0,t.jsx)(s.code,{children:"<object>"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"style-src 'self' style.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable loading stylesheets from the own domain and ",(0,t.jsx)(s.code,{children:"style.example.org "}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"img-src 'self' imgs.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable loading images from the own domain and ",(0,t.jsx)(s.code,{children:"imgs.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"media-scr 'self' media.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable loading media elements from the own domain and ",(0,t.jsx)(s.code,{children:"media.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"child-src 'self'"})}),(0,t.jsxs)(s.td,{children:["Define that in ",(0,t.jsx)(s.code,{children:"<frame>"})," and ",(0,t.jsx)(s.code,{children:"<iframe>"})," elements only pages from the own domain may be loaded."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"font-src 'self' fonts.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable loading fonts from the own domain and ",(0,t.jsx)(s.code,{children:"fonts.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"connect-src 'self' api.example.org"})}),(0,t.jsxs)(s.td,{children:["Enable connections with script interfaces, such as ",(0,t.jsx)(s.code,{children:"XMLHttpRequest"})," or ",(0,t.jsx)(s.code,{children:"WebSocket"})," to the own domain and ",(0,t.jsx)(s.code,{children:"api.example.org"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"manifest-src 'self'"})}),(0,t.jsx)(s.td,{children:"Enable loading manifests from the own domain."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"frame-ancestors 'self'"})}),(0,t.jsx)(s.td,{children:"Define that this page may only be used as a frame on pages of the own domain."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"form-action 'self'"})}),(0,t.jsx)(s.td,{children:"Ensures that form actions can only be of the own domain."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"sandbox"})}),(0,t.jsx)(s.td,{children:"Enables a sandbox that blocks most actions on the page. More Information: CSP: sandbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"plugin-types application/x-java-applet"})}),(0,t.jsxs)(s.td,{children:["Allows embedding an ",(0,t.jsx)(s.code,{children:"<applet>"}),". This only works if ",(0,t.jsx)(s.code,{children:"object-src"})," is not set to 'none'."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"block-all-mixed-content"})}),(0,t.jsx)(s.td,{children:"Prevents browser to load mixed content (such as HTTP and HTTPS mixed elements)."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"upgrade-insecure-requests"})}),(0,t.jsx)(s.td,{children:"Download all resources over an HTTPS connection."})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"A specific and restrictive policy can be default-src 'self.' Test your configuration thoroughly, as you may not want to block your analytics script or other third-party resources."}),"\n",(0,t.jsx)(s.h3,{id:"referrer-policy",children:(0,t.jsx)(s.code,{children:"Referrer-Policy"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"Referrer-Policy"})," header defines how much information about the referrer is sent when the user selects a link. The referrer may leak sensitive information such as user-specific URLs. Therefore, the referrer-policy might be set to some more restrictive value. A relatively secure setting is strict-origin-when-cross-origin."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"no-referrer"})}),(0,t.jsx)(s.td,{children:"Do not include any referrer information on requests."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"no-referrer-when-downgrade"})}),(0,t.jsx)(s.td,{children:"Do not send the referrer when the actual connection is an HTTPS request and the new request is HTTP."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"origin"})}),(0,t.jsx)(s.td,{children:"Send the origin as referrer but do not include any path information."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"origin-when-cross-origin"})}),(0,t.jsx)(s.td,{children:"Send the origin as a referrer when the new request is on another domain, and all information for same-origin cases."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"same-origin"})}),(0,t.jsx)(s.td,{children:"Send the referrer only when the request stays in the current domain."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"strict-origin"})}),(0,t.jsx)(s.td,{children:"Send the origin as a referrer, but only when the request is not downgraded from HTTPS to HTTP."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"strict-origin-when-cross-origin"})}),(0,t.jsx)(s.td,{children:"Send the origin as a referrer to cross-origin requests and the full referrer on same-origin requests but only when the request is no downgrade."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"unsafe-url"})}),(0,t.jsx)(s.td,{children:"Always send the full URL as a referrer."})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"cache-control",children:(0,t.jsx)(s.code,{children:"Cache-Control"})}),"\n",(0,t.jsx)(s.p,{children:"The Cache-Control header defines how caching in the browser is configured. Depending on the header's value, the browser may cache the website, including any sensitive information. The header should be set to no-store for pages where confidentiality is an issue."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Effect"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"must-revalidate"})}),(0,t.jsx)(s.td,{children:"The cache must revalidate the state of the resource before using it."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"no-cache"})}),(0,t.jsx)(s.td,{children:"Send the request even if the cache has stored the resource."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"no-store"})}),(0,t.jsx)(s.td,{children:"Do not store the resource in any cache."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"no-transform"})}),(0,t.jsx)(s.td,{children:"Do not transform the resource (e.g., change the image format to store cache space)."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"public"})}),(0,t.jsx)(s.td,{children:"Allow storing the resource in any cache."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"private"})}),(0,t.jsx)(s.td,{children:"Allow to store the resource in a user-specific cache, but not a shared cache."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"proxy-revalidate"})}),(0,t.jsx)(s.td,{children:"Same as must-revalidate for shared caches."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"max-age=<seconds>"})}),(0,t.jsx)(s.td,{children:"Configure the time for which the resource will be treated as fresh."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"s-maxage=<seconds>"})}),(0,t.jsx)(s.td,{children:"Overwrite a max-age or Expires header, but is only used for shared caches."})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"access-control-allow-origin",children:(0,t.jsx)(s.code,{children:"Access-Control-Allow-Origin"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"Access-Control-Allow-Origin"})," header defines which applications may consume your API. It should be set to the domain of your frontend, such as:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Access-Control-Allow-Origin: https://example.org\n"})}),"\n",(0,t.jsxs)(s.p,{children:["See ",(0,t.jsx)(s.a,{href:"https://crashtest-security.com/multiple-values-access-control-allow-origin/",children:"this topic"})," if you have multiple applications using your API."]})]})}function h(e={}){const{wrapper:s}={...(0,n.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},34033:(e,s,r)=>{r.d(s,{Z:()=>t});const t=r.p+"assets/images/Security_Assessment_IncreaseTLSKeySize-e8b60f72154550155e179584ceb5f1ee.png"},11151:(e,s,r)=>{r.d(s,{Z:()=>d,a:()=>c});var t=r(67294);const n={},i=t.createContext(n);function c(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);