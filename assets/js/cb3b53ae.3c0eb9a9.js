"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[29456],{1505:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var t=i(85893),s=i(11151);const a={title:"Use YAML to add Static Analysis to Azure DevOps pipelines",slug:"/r/Use_YAML_to_Add_Veracode_Analysis_to_Azure_DevOps_Pipelines"},o=void 0,r={id:"guides/integrations/cicd/azure_devops_integration/azure_add_static_build_pipeline_yaml/README",title:"Use YAML to add Static Analysis to Azure DevOps pipelines",description:"You can use YAML to add the Veracode Azure DevOps Extension and integrate Veracode Static Analysis into your Azure DevOps build pipelines.",source:"@site/docs/guides/04_integrations/03_cicd/05_azure_devops_integration/04_azure_add_static_build_pipeline_yaml/README.md",sourceDirName:"guides/04_integrations/03_cicd/05_azure_devops_integration/04_azure_add_static_build_pipeline_yaml",slug:"/r/Use_YAML_to_Add_Veracode_Analysis_to_Azure_DevOps_Pipelines",permalink:"/km-docusaurus-test/r/Use_YAML_to_Add_Veracode_Analysis_to_Azure_DevOps_Pipelines",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Use YAML to add Static Analysis to Azure DevOps pipelines",slug:"/r/Use_YAML_to_Add_Veracode_Analysis_to_Azure_DevOps_Pipelines"},sidebar:"tutorialSidebar",previous:{title:"Add Static Analysis to Azure DevOps pipelines",permalink:"/km-docusaurus-test/r/t_TFS_config_build_pipe"},next:{title:"Azure DevOps YAML properties for Upload and Scan",permalink:"/km-docusaurus-test/r/Azure_DevOps_YAML_Properties_for_Upload_and_Scan"}},l={},c=[];function d(e){const n={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"You can use YAML to add the Veracode Azure DevOps Extension and integrate Veracode Static Analysis into your Azure DevOps build pipelines."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Before you begin:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Before uploading an application, you must package it to include the required debug symbols, as described in the ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/compilation_packaging",children:"packaging requirements"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Generated ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/c_api_credentials3",children:"Veracode API credentials"}),". If your credentials contain variables, you must start each variable with a ",(0,t.jsx)(n.code,{children:"$"})," and wrap the variable value in parentheses. For example, you enter the ",(0,t.jsx)(n.code,{children:"id"})," variable as ",(0,t.jsx)(n.code,{children:"$(Id)"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The extension uses the variable names ",(0,t.jsx)(n.code,{children:"VERACODE_API_KEY_ID"})," and ",(0,t.jsx)(n.code,{children:"VERACODE_API_KEY_SECRET"})," for the API credentials. If you use custom variables in your pipelines, ensure that none of your variable names conflict with these variable names for the API credentials."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"If you want to upload multiple artifacts for scanning, you have prepared one or more ZIP archives:"}),"\n",(0,t.jsx)(n.p,{children:"a. Add the artifacts to one or more ZIP archives."}),"\n",(0,t.jsx)(n.p,{children:"b. Ensure the ZIP archives are in the same upload file path location."}),"\n",(0,t.jsx)(n.p,{children:"c. Prepare the ZIP archives for uploading to Veracode using a separate build step or build steps in your pipeline."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If you have an ASP.NET application, see ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/c_precompilation",children:"Configure an Azure DevOps build for ASP.NET applications"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"To complete this task:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"In your Azure DevOps project, navigate to the YAML file for the pipeline in which to add the Veracode task."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Select ",(0,t.jsx)(n.strong,{children:"Show assistant"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Search for ",(0,t.jsx)(n.code,{children:"veracode"}),", then select the ",(0,t.jsx)(n.strong,{children:"Veracode Upload and Scan"})," task."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"In the Veracode Upload and Scan window, in the Connection Details section, select a connection source for connecting to Veracode:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service Connection"}),": select an existing service connection that uses your Veracode API credentials or ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/Create_a_Service_Connection_in_Azure_DevOps",children:"create a new service connection"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Credentials"}),": enter your Veracode API credentials."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"In the Veracode Scan Settings section, enter the name of the associated application profile, a unique scan name, and the filepath to either the application artifact or the folder containing the artifacts to upload to Veracode."}),"\n",(0,t.jsxs)(n.p,{children:["For a .NET application, if you have additional published projects from a solution, include them in the archive to upload and analyze. Add any JavaScript files to a separate ZIP archive according to the packaging instructions in the ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/compilation_packaging",children:"packaging requirements"}),". Include only the file types for languages and platforms that Veracode can scan in a ZIP archive to improve uploading and scan speed. See the ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/archive-files?view=azure-devops",children:"Microsoft Archive Files task"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["If this is not an existing Veracode application, select the ",(0,t.jsx)(n.strong,{children:"Create Application Profile"})," checkbox in the Advanced Scan Settings section to have Veracode create an ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/request_profile",children:"application profile"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Application names in Azure DevOps are case-sensitive."})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the Advanced Scan Settings section, if you are using a development sandbox, enter a sandbox name or select ",(0,t.jsx)(n.strong,{children:"Create Sandbox"})," to create one."]}),"\n",(0,t.jsxs)(n.p,{children:["In the Optional Arguments field, enter any ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/r_uploadandscan",children:"optional parameters"})," to apply to the Upload and Scan action. For example, you can use the optional parameters to include and exclude files during the scan."]}),"\n",(0,t.jsxs)(n.p,{children:["The following example specifies to include all DLL files, exclude all EXE files, scan in a sandbox named ",(0,t.jsx)(n.code,{children:"mysandbox"}),", which Veracode creates if the sandbox does not already exist, and to delete a scan with a status of incomplete, no modules defined, failed, or cancelled:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"-include *.dll -exclude *.exe -createsandbox true -sandboxname mysandbox -deleteIncompleteScan 1\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Do not enclose any of the values in single or double quotations."})}),"\n",(0,t.jsxs)(n.p,{children:["You can ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/t_hide_password",children:"hide a proxy password"})," during the Upload and Scan action."]}),"\n",(0,t.jsxs)(n.p,{children:["If the application profile does not exist, select the ",(0,t.jsx)(n.strong,{children:"Create Application Profile"})," checkbox to create it. You can select the ",(0,t.jsx)(n.strong,{children:"Fail build if Upload and Scan build step fails"})," checkbox to prevent the build from continuing if the Upload and Scan build step fails."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the Veracode Scan Results section, select the ",(0,t.jsx)(n.strong,{children:"Import Results upon Scan Completion"})," checkbox to import the scan results. You can select the option under it to stop the build if the scan results indicate that the application has failed your security policy."]}),"\n",(0,t.jsxs)(n.p,{children:["Selecting either checkbox reserves an assigned build agent to wait until the scan has completed successfully and the scan results are available. With one or both checkboxes selected, you can enter the build agent wait time, in minutes, for failing the build if no scan results are available. The value range is ",(0,t.jsx)(n.code,{children:"30"})," to ",(0,t.jsx)(n.code,{children:"1440"})," (24 hours) and the default is ",(0,t.jsx)(n.code,{children:"360"})," (6 hours). If you enter a value outside this range, the build fails."]}),"\n",(0,t.jsx)(n.p,{children:"If neither checkbox is selected, the build agent uploads the binaries to Veracode and continues to the next build task in the task list."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Select ",(0,t.jsx)(n.strong,{children:"Add"})," to add the Upload and Scan task to the YAML file in your build pipeline."]}),"\n",(0,t.jsxs)(n.p,{children:["This example shows a YAML file for building and scanning a .NET application. It specifies to access Veracode using a service connection. For descriptions of all YAML properties for the Upload and Scan task, see ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/Azure_DevOps_YAML_Properties_for_Upload_and_Scan",children:"Azure DevOps YAML properties for Upload and Scan"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# .NET Desktop\n# Build and run tests for .NET Desktop or Windows classic desktop solutions.\n# Add steps that publish symbols, save build artifacts, and more:\n# https://docs.microsoft.com/azure/devops/pipelines/apps/windows/dot-net\n\ntrigger:\n- master\n\npool:\n  vmImage: 'windows-latest'\n\nvariables:\n   solution: '**/*.sln'\n   buildPlatform: 'Any CPU'\n   buildConfiguration: 'Debug' # required as part of Veracode packaging for task: VSBuild@1\n \nsteps:\n- task: NuGetToolInstaller@1\n \n- task: NuGetCommand@2\n  inputs:\n    restoreSolution: '$(solution)'\n \n- task: VSBuild@1\n  inputs:\n    solution: '$(solution)'\n    platform: '$(buildPlatform)'\n    configuration: '$(buildConfiguration)'\n \n- task: VSTest@2\n  inputs:\n    platform: '$(buildPlatform)'\n    configuration: '$(buildConfiguration)'\n \n- task: DownloadPipelineArtifact@2\n  inputs:\n    patterns: '**/*.exe,**/*.dll,**/*.pdb' # ensures Veracode gets the PDB files for Static Analyisis\n \n# This task makes the pipeline build artifacts available in a known location for upload to Veracode\n- task: PublishPipelineArtifact@1\n  inputs:\n    targetPath: $(System.DefaultWorkingDirectory)/bin/Debug\n    artifactName: Debug\n     \n- task: Veracode@3\n  inputs:\n    ConnectionDetailsSelection: 'Service Connection' # access Veracode with service connection or Veracode API credentials\n    AnalysisService: 'Veracode Service Account' # service connection name for accessing Veracode\n    veracodeAppProfile: '$(system.teamProject)' # Veracode application profile to scan\n    version: '$(build.buildNumber)' # name of the scan to run\n    filepath: '$(System.DefaultWorkingDirectory)/bin/Debug' # filepath or folderpath of files to upload to Veracode\n    optargs: '-criticality high -include *.dll -exclude *.exe -createsandbox true -sandboxname mysandbox -deleteIncompleteScan 1' # scan criticality is high, include DLL modules, exclude EXE modules, create sandbox mysandbox during scan, delete a scan with status of incomplete, no modules defined, failed, or cancelled \n    createSandBox: false # true to scan of new development sandbox\n    createProfile: true # false to enforce using existing profiles\n    failBuildIfUploadAndScanBuildStepFails: false # true to fail build if Upload and Scan task fails to start\n    importResults: true # required to view Veracode results in Azure DevOps\n    failBuildOnPolicyFail: false # true to fail the build if application fails policy\n    maximumWaitTime: '360' # wait time, in minutes, to fail the build if no scan results available\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Optionally, to add debugging to your pipeline, add a new variable and enter these values in the New variable window:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Name: ",(0,t.jsx)(n.code,{children:"system.debug"})]}),"\n",(0,t.jsxs)(n.li,{children:["Value: ",(0,t.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Results:"})}),"\n",(0,t.jsxs)(n.p,{children:["After the scan is complete, in your build definition, you can select the ",(0,t.jsx)(n.strong,{children:"Veracode Scan Summary"})," tab to view the scan results."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Next steps:"})}),"\n",(0,t.jsxs)(n.p,{children:["If you want to use the Veracode Azure DevOps flaw import feature in your build definition, ",(0,t.jsx)(n.a,{href:"/km-docusaurus-test/r/Use_YAML_to_Configure_Azure_DevOps_Pipelines_for_Importing_Flaws",children:"configure the additional related build variables"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>o});var t=i(67294);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);