"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[48749],{81024:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var r=i(85893),t=i(11151);const a={title:"React Native packaging",slug:"/r/c_compilation_react"},c=void 0,o={id:"guides/packaging/react",title:"React Native packaging",description:"Your React Native applications must meet specific compilation requirements before you can submit them for scanning.",source:"@site/docs/guides/03_packaging/26_react.md",sourceDirName:"guides/03_packaging",slug:"/r/c_compilation_react",permalink:"/km-docusaurus-test/r/c_compilation_react",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:26,frontMatter:{title:"React Native packaging",slug:"/r/c_compilation_react"},sidebar:"tutorialSidebar",previous:{title:"Python packaging",permalink:"/km-docusaurus-test/r/compilation_python"},next:{title:"RPG packaging",permalink:"/km-docusaurus-test/r/compilation_rpg"}},s={},d=[{value:"Required files",id:"required-files",level:2},{value:"Supported React Native versions",id:"supported-react-native-versions",level:2},{value:"Packaging guidance",id:"packaging-guidance",level:2},{value:"Option 1: (Preferred) Package as source code",id:"option-1-preferred-package-as-source-code",level:2},{value:"Option 2: Package as iOS IPA: Modification of the <code>project.pbxproj</code> file",id:"option-2-package-as-ios-ipa-modification-of-the-projectpbxproj-file",level:2},{value:"Option 3: Package as Android APK",id:"option-3-package-as-android-apk",level:2},{value:"Option 4: Legacy - Package as Android APK for React Native version before 0.72.0",id:"option-4-legacy---package-as-android-apk-for-react-native-version-before-0720",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Your React Native applications must meet specific compilation requirements before you can submit them for scanning."}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/km-docusaurus-test/r/r_supported_table",children:"Supported languages and platforms"})," for instructions for other platforms."]}),"\n",(0,r.jsx)(n.h2,{id:"required-files",children:"Required files"}),"\n",(0,r.jsx)(n.p,{children:"Veracode recommends that you submit your React Native application as an archive containing the source code. You can also submit your application as a compiled iOS archive (IPA) or a compiled Android package (APK)."}),"\n",(0,r.jsx)(n.h2,{id:"supported-react-native-versions",children:"Supported React Native versions"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Technology"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Version"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JavaScript/React Native"}),(0,r.jsx)(n.td,{children:"Android, iOS"}),(0,r.jsx)(n.td,{children:"0.50\u20130.7x"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"packaging-guidance",children:"Packaging guidance"}),"\n",(0,r.jsx)(n.p,{children:"Veracode Static Analysis supports three ways of packaging your React Native application.\nPlease select only one to prevent duplicate flaws."}),"\n",(0,r.jsx)(n.h2,{id:"option-1-preferred-package-as-source-code",children:"Option 1: (Preferred) Package as source code"}),"\n",(0,r.jsxs)(n.p,{children:["When you upload a ZIP archive of the source code to Veracode, follow the ",(0,r.jsx)(n.a,{href:"/km-docusaurus-test/r/compilation_jscript",children:"packaging guidelines for JavaScript"}),". Do not submit files that you built using webpack or other packaging mechanisms. Include the packaging information for NPM, Yarn, or Bower, but do not  include the ",(0,r.jsx)(n.code,{children:"node_modules"})," directory. The source files must be UTF-8 encoded."]}),"\n",(0,r.jsxs)(n.h2,{id:"option-2-package-as-ios-ipa-modification-of-the-projectpbxproj-file",children:["Option 2: Package as iOS IPA: Modification of the ",(0,r.jsx)(n.code,{children:"project.pbxproj"})," file"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"This packaging option requires React Native version 0.50\u20140.7x."})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.code,{children:"project.pbxproj"})," file in any editor. This file is typically located in ",(0,r.jsx)(n.code,{children:"PROJECT_ROOT/ios/PROJECT_NAME.xcodeproj/"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Locate section with ",(0,r.jsx)(n.code,{children:"Bundle React Native code and images"})," description. Under ",(0,r.jsx)(n.code,{children:"shellScript"})," variable, you see the prepared ",(0,r.jsx)(n.code,{children:"react-native-xcode.sh"})," execution."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Add ",(0,r.jsx)(n.code,{children:"export SOURCEMAP_FILE=main.jsbundle.map"})," to the ",(0,r.jsx)(n.code,{children:"shellScript"})," variable, right before ",(0,r.jsx)(n.code,{children:"react-native-xcode.sh"})," execution:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before modification:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'shellScript = "set -e\\n\\nexport NODE_BINARY=node\\n../node_modules/react-native/scripts/react-native-xcode.sh\\n";\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After modification:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'shellScript = "set -e\\n\\nexport NODE_BINARY=node\\nexport SOURCEMAP_FILE=main.jsbundle.map\\n../node_modules/react-native/scripts/react-native-xcode.sh\\n";\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Build an archive in either xcode or at the command line."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Verify that ",(0,r.jsx)(n.code,{children:"main.jsbundle"})," is in the archive and that the ",(0,r.jsx)(n.code,{children:"main.jsbundle.map"})," is either in the React Native project root or in the archive."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["If the ",(0,r.jsx)(n.code,{children:"main.jsbundle.map"})," is not present in the ",(0,r.jsx)(n.code,{children:"xcarchive"}),", copy it from project root to the same directory inside the ",(0,r.jsx)(n.code,{children:"xcarchive"}),", where ",(0,r.jsx)(n.code,{children:"main.jsbundle"})," is located."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Build the IPA file out of the archive. Then, verify that both ",(0,r.jsx)(n.code,{children:"main.jsbundle"})," and ",(0,r.jsx)(n.code,{children:"main.jsbundle.map"})," files are present in the IPA file."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Submit a scan of the IPA file."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"option-3-package-as-android-apk",children:"Option 3: Package as Android APK"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Disable hermes by setting ",(0,r.jsx)(n.code,{children:"hermesEnabled=false"})," in ",(0,r.jsx)(n.code,{children:"android/gradle.properties"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Open ",(0,r.jsx)(n.code,{children:"PROJECT_ROOT/android/app/build.gradle"})," and, in the ",(0,r.jsx)(n.code,{children:"react"})," section, add the following:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"debuggableVariants = []"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'bundleAssetName = "index.jsbundle"'})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Run  ",(0,r.jsx)(n.code,{children:"./gradlew assembleDebug"})," in the ",(0,r.jsx)(n.code,{children:"PROJECT_ROOT/android"})," directory."]}),"\n",(0,r.jsxs)(n.li,{children:["Use any suitable archiver available on your platform to add the bundle and the map into the APK archive. The ",(0,r.jsx)(n.code,{children:"APK_FILE_ROOT/assets"})," directory should now include ",(0,r.jsx)(n.code,{children:"index.jsbundle"})," and ",(0,r.jsx)(n.code,{children:"index.jsbundle.map"}),".  Locate those files by, for example, running ",(0,r.jsx)(n.code,{children:'find . -type f -name "index.jsbundle"'})," and ",(0,r.jsx)(n.code,{children:'find . -type f -name "index.jsbundle.map"'})," in the ",(0,r.jsx)(n.code,{children:"PROJECT_ROOT"})," directory. By default, those files reside in:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"PROJECT_ROOT/android/app/build/generated/assets/createBundleDebugJsAndAssets/index.jsbundle"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"PROJECT_ROOT/android/app/build/generated/sourcemaps/react/debug/index.jsbundle.map"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"option-4-legacy---package-as-android-apk-for-react-native-version-before-0720",children:"Option 4: Legacy - Package as Android APK for React Native version before 0.72.0"}),"\n",(0,r.jsx)(n.p,{children:"You must modify two components to produce a package for analysis, in this sequence:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Modify the Gradle configuration file ",(0,r.jsx)(n.code,{children:"build.gradle"})," to define the bundle name:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:' project.ext.react = [\n      bundleAssetName: "main.jsbundle",\n]\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Edit the Android packager script ",(0,r.jsx)(n.code,{children:"./node_modules/react-native/react.gradle"})," to add these modifications to the build script:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'def jsBundleMapFile = "${jsBundleFile}.map"\n      "--sourcemap-output", jsBundleMapFile\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"After you make these modifications to the build scripts, use Gradle to create an APK file. Then, upload that file to Veracode for analysis."})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>c});var r=i(67294);const t={},a=r.createContext(t);function c(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);