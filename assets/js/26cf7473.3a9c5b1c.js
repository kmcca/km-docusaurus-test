"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[18336],{1119:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=s(85893),i=s(11151);const r={title:"Prevent SSL BREACH attacks",slug:"/r/prevent-ssl-breach"},a=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/prevent-ssl-breach",title:"Prevent SSL BREACH attacks",description:"A server vulnerable to BREACH (Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext) allows an attacker to decrypt cookie contents such as session information. Learn here how you can prevent BREACH.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/11_prevent-ssl-breach.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/prevent-ssl-breach",permalink:"/km-docusaurus-test/r/prevent-ssl-breach",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{title:"Prevent SSL BREACH attacks",slug:"/r/prevent-ssl-breach"},sidebar:"tutorialSidebar",previous:{title:"Prevent SSL CRIME attacks",permalink:"/km-docusaurus-test/r/prevent-ssl-crime"},next:{title:"Enable TLS encryption",permalink:"/km-docusaurus-test/r/enable-tls-encryption"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Apache",id:"apache",level:3},{value:"Possible BREACH Attack Solutions",id:"possible-breach-attack-solutions",level:2},{value:"HSTS - Secure Channels: Strict Transport Security",id:"hsts---secure-channels-strict-transport-security",level:3},{value:"Certificate pinning",id:"certificate-pinning",level:3},{value:"How could Google/Chrome be resilient to DigiNotar attack?",id:"how-could-googlechrome-be-resilient-to-diginotar-attack",level:3},{value:"Secure Channels: DNSSEC for TLS",id:"secure-channels-dnssec-for-tls",level:3}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"A server vulnerable to BREACH (Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext) allows an attacker to decrypt cookie contents such as session information. Learn here how you can prevent BREACH."}),"\n",(0,n.jsx)(t.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Security_Assessment_PreventSSLBreach",src:s(34033).Z+"",width:"907",height:"332"})}),"\n",(0,n.jsxs)(t.p,{children:["CVSS vector: ",(0,n.jsxs)(t.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":L","/I",":L","/A",":N"]})]}),"\n",(0,n.jsx)(t.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,n.jsx)(t.p,{children:"The BREACH attack can be considered an instance of the CRIME attack (Compression Ratio Info-leak Made Easy) attack vector as it is based on and largely follows its logic. It targets vulnerabilities in data compression in the HTTP protocol."}),"\n",(0,n.jsx)(t.p,{children:"For a BREACH attack to be successful, several conditions must be met. Vulnerable websites must:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Use HTTP-level compression"}),"\n",(0,n.jsx)(t.li,{children:"Reflect user input (e.g., a username that is given from the login form) in the HTTP response body"}),"\n",(0,n.jsx)(t.li,{children:"Contain a secret (e.g., a CSRF token) in the response body that is of interest to the attacker"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"A server vulnerable to BREACH attacks allows an attacker to decrypt cookie contents such as session information, including login tokens, email addresses, and other types of sensitive data."}),"\n",(0,n.jsx)(t.p,{children:"This attack can be successfully executed in less than a minute."}),"\n",(0,n.jsx)(t.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,n.jsxs)(t.p,{children:["Unlike previous attacks, such as ",(0,n.jsx)(t.a,{href:"/km-docusaurus-test/r/prevent-ssl-beast",children:"BEAST"})," or ",(0,n.jsx)(t.a,{href:"/km-docusaurus-test/r/prevent-ssl-lucky13",children:"LUCKY 13"}),", this attack does not require SSL/TLS-layer compression and can work against any cipher suite. For this reason, turning off TLS compression does not affect the possibility of a BREACH attack."]}),"\n",(0,n.jsx)(t.p,{children:"The attack is easier to execute against stream ciphers because the responses' size is easier to establish. However, against block ciphers, attackers must work on aligning the output to the ciphertext blocks more precisely."}),"\n",(0,n.jsx)(t.p,{children:"Technically, the most straightforward form of mitigation is disabling HTTP compression, which will lead to more significant sites that need to be transferred and is not a viable solution."}),"\n",(0,n.jsx)(t.p,{children:"Several ways of mitigating this attack exist. These include:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Disabling the compression-only if the referrer is not the own application"}),"\n",(0,n.jsx)(t.li,{children:"Separating any sensitive data (i.e., secrets) from user input"}),"\n",(0,n.jsx)(t.li,{children:"Using a CSRF token to protect pages that contain sensitive information thanks to the SameSite Cookie attribute"}),"\n",(0,n.jsx)(t.li,{children:"Hiding traffic length by including random numbers of bytes to responses (aka HTTP chunked encoding)"}),"\n",(0,n.jsx)(t.li,{children:"Randomizing token value in every response"}),"\n",(0,n.jsx)(t.li,{children:"Limiting the rate of requests"}),"\n",(0,n.jsx)(t.li,{children:"Monitoring traffic to spot attacks as they occur"}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"apache",children:"Apache"}),"\n",(0,n.jsx)(t.p,{children:"To disable HTTP compression from requests with different referrers, use the following settings:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"SetOutputFilter DEFLATE  \n       BrowserMatch ^Mozilla/4 gzip-only-text/html  \n       BrowserMatch ^Mozilla/4\\.0[678] no-gzip  \n       BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html  \n       SetEnvIfNoCase Request_URI \\.(?:gif|jpe?g|png|zip|gz|tgz|htc)$ no-gzip dont-vary  \n       # BREACH migitation  \n       SetEnvIfNoCase Referer .* self_referer=no  \n       SetEnvIfNoCase Referer ^https://www\\.example\\.org/ self_referer=yes  \n       SetEnvIf self_referer ^no$ no-gzip  \n       Header append Vary User-Agent env=!dont-vary\n"})}),"\n",(0,n.jsx)(t.h2,{id:"possible-breach-attack-solutions",children:"Possible BREACH Attack Solutions"}),"\n",(0,n.jsx)(t.h3,{id:"hsts---secure-channels-strict-transport-security",children:"HSTS - Secure Channels: Strict Transport Security"}),"\n",(0,n.jsx)(t.p,{children:'The server declares, "I only talk TLS."'}),"\n",(0,n.jsx)(t.p,{children:"Example: HTTP(S) Response Header: Strict-Transport-Security: max-age=15768000; includeSubDomains"}),"\n",(0,n.jsx)(t.p,{children:"The header can be cached and prevents leakage using subdomain content through non-TLS links in the content."}),"\n",(0,n.jsx)(t.p,{children:'Weakness: "Trust on first use."'}),"\n",(0,n.jsx)(t.h3,{id:"certificate-pinning",children:"Certificate pinning"}),"\n",(0,n.jsx)(t.p,{children:"Server identities tend to be long-lived, but clients have to re-establish the server identity on every TLS session."}),"\n",(0,n.jsx)(t.h3,{id:"how-could-googlechrome-be-resilient-to-diginotar-attack",children:"How could Google/Chrome be resilient to DigiNotar attack?"}),"\n",(0,n.jsxs)(t.p,{children:['Google built-in "preloaded" fingerprints for the known public keys in the certificate chains of Google properties. Thereby exposing the false ',(0,n.jsx)(t.code,{children:"*.google.com"})," certificate DigiNotar signed. But, preloading does not scale."]}),"\n",(0,n.jsx)(t.p,{children:"Could use an HTTP header, i.e., transmit the SHA1 or SHA256 hash of the Subject Public Key Info structure of the X.509 certificate. (You could pin to end entity, intermediary, root. Select your degree of precision.)"}),"\n",(0,n.jsx)(t.h3,{id:"secure-channels-dnssec-for-tls",children:"Secure Channels: DNSSEC for TLS"}),"\n",(0,n.jsx)(t.p,{children:"DNSSEC can be used to declare supported protocols for domains"}),"\n",(0,n.jsx)(t.p,{children:"DNSSEC can be used to declare a server certificate for the domain"}),"\n",(0,n.jsx)(t.p,{children:"Advantage: Advantage of trusted signed source"})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},34033:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/Security_Assessment_IncreaseTLSKeySize-e8b60f72154550155e179584ceb5f1ee.png"},11151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>a});var n=s(67294);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);