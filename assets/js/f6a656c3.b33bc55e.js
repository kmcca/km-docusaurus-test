"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[60786],{53967:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=s(85893),i=s(11151);const a={title:"Prevent Ticketbleed attacks",slug:"/r/prevent-ticketbleed"},r=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/prevent-ticketbleed",title:"Prevent Ticketbleed attacks",description:"The proprietary F5 TLS stack is vulnerable to Ticketbleed. It exposes 31 bytes per request to the attacker and ultimately invalidates the encryption.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/21_prevent-ticketbleed.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/prevent-ticketbleed",permalink:"/km-docusaurus-test/r/prevent-ticketbleed",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:21,frontMatter:{title:"Prevent Ticketbleed attacks",slug:"/r/prevent-ticketbleed"},sidebar:"tutorialSidebar",previous:{title:"Disable SSL insecure algorithms",permalink:"/km-docusaurus-test/r/disable-ssl-insecure-algorithm"},next:{title:"Prevent SSL DROWN attacks",permalink:"/km-docusaurus-test/r/prevent-ssl-drown"}},l={},c=[{value:"Security Assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2}];function d(e){const t={a:"a",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"The proprietary F5 TLS stack is vulnerable to Ticketbleed. It exposes 31 bytes per request to the attacker and ultimately invalidates the encryption."}),"\n",(0,n.jsx)(t.h2,{id:"security-assessment",children:"Security Assessment"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"Security_Assessment_PreventTicketbleed",src:s(38526).Z+"",width:"907",height:"332"}),"\nCVSS vector: ",(0,n.jsxs)(t.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2016-9244&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",children:["AV",":N","/AC",":L","/PR",":N","/UI",":N","/S",":U","/C",":H","/I",":N","/A",":N"]})]}),"\n",(0,n.jsx)(t.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,n.jsxs)(t.p,{children:["The Ticketbleed vulnerability (",(0,n.jsx)(t.a,{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9244",children:"CVE-2016-9244"}),") was ",(0,n.jsx)(t.a,{href:"https://words.filippo.io/finding-ticketbleed/",children:"discovered by Filippo Valsorda in 2017"})," while examining a bug report from a customer using an F5 load balancer between their server and the Cloudflare Railgun. This software vulnerability affects the implementation of session tickets in the TLS/SSL stack of F5 appliances, such as a BIG-IP virtual server. It specifically applies to those appliances with the non-default session ticket option enabled."]}),"\n",(0,n.jsx)(t.p,{children:"Session tickets are used during the handshake between client and server. Along with the ClientHello, the client sends a session ticket to the server to resume a previous session rather than negotiate a new one. Along with encrypted key material of a prior connection, the session ticket includes a session ID which the server is supposed to echo back to the client to confirm the ticket acceptance and the session resumption."}),"\n",(0,n.jsx)(t.p,{children:"Filippo found that the resumption technique failed because the F5 device assumed that the session ID had to be of a certain length. Session IDs can be between 1 and 31 bytes long, yet the F5 devices would always echo back 32 byte IDs. The F5 server would pad the ID to its maximum length instead of returning the same ID to the client. This would confuse the client and cause a bug."}),"\n",(0,n.jsx)(t.p,{children:"The problem is that instead of random padding, the server would send unallocated or uninitialized memory in its response. In other words, the server would inadvertently reveal data that could be sensitive."}),"\n",(0,n.jsx)(t.p,{children:"An attacker could deliberately send a 1-byte session ID to trick the server into returning 31 bytes of memory."}),"\n",(0,n.jsx)(t.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,n.jsx)(t.p,{children:"To prevent Ticketbleed, you must either upgrade the version of your appliance or change its settings."}),"\n",(0,n.jsxs)(t.p,{children:["A complete list of the affected versions of appliances can be found on the ",(0,n.jsx)(t.a,{href:"https://support.f5.com/csp/article/K05121675",children:"F5 website"}),". These are primarily versions 12.0.0-12.1.2, and 11.4.0-11.6.1. Therefore, if you have a device running a version known to be vulnerable, you must upgrade it to one known to be without the vulnerability."]}),"\n",(0,n.jsx)(t.p,{children:"Some appliances do not have newer versions, so it may not be possible to upgrade to a non-vulnerable version. In this case, you can mitigate the issue by disabling the session ticket option. Though this solves the problem entirely, it introduces performance degradation because sessions cannot be resumed."}),"\n",(0,n.jsx)(t.p,{children:"To disable session tickets, follow the instructions provided by F5:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Sign in to the Configuration utility."}),"\n",(0,n.jsxs)(t.li,{children:["Go to ",(0,n.jsx)(t.strong,{children:"Local Traffic > Profiles > SSL > Client"}),"."]}),"\n",(0,n.jsx)(t.li,{children:"Select the Advanced configuration option."}),"\n",(0,n.jsx)(t.li,{children:"Uncheck the session ticket box to disable the feature."}),"\n",(0,n.jsxs)(t.li,{children:["Select ",(0,n.jsx)(t.strong,{children:"Update"})," to apply the changes."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Disabling session tickets should not have any adverse effects on your system."})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},38526:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/Security_Assessment_PreventTicketbleed-db8b9c926109df85720b50d0fe7b1fa4.png"},11151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>r});var n=s(67294);const i={},a=n.createContext(i);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);