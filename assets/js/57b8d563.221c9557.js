"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[75090],{81977:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>n,metadata:()=>o,toc:()=>l});var a=t(85893),s=t(11151);const n={title:"Prevent insecure deserialization attacks",slug:"/r/insecure-deserialization"},r=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_misc/insecure-deserialization",title:"Prevent insecure deserialization attacks",description:"Insecure Deserialization is an attack where a manipulated object is injected into the context of the web application.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/09_dast_essentials_misc/06_insecure-deserialization.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/09_dast_essentials_misc",slug:"/r/insecure-deserialization",permalink:"/km-docusaurus-test/r/insecure-deserialization",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Prevent insecure deserialization attacks",slug:"/r/insecure-deserialization"},sidebar:"tutorialSidebar",previous:{title:"Prevent authentication and session management attacks",permalink:"/km-docusaurus-test/r/broken-authentication-and-session-management"},next:{title:"Prevent sensitive data exposure attacks",permalink:"/km-docusaurus-test/r/sensitive-data-exposure"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Attack examples",id:"attack-examples",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Test for insecure deserialization",id:"test-for-insecure-deserialization",level:3}];function d(e){const i={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.p,{children:"Insecure Deserialization is an attack where a manipulated object is injected into the context of the web application."}),"\n",(0,a.jsx)(i.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{alt:"Security_Assessment_InsecureDeserialization",src:t(79645).Z+"",width:"907",height:"332"})}),"\n",(0,a.jsxs)(i.p,{children:["CVSS vector:  ",(0,a.jsxs)(i.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/CR:X/IR:X/AR:X/MAV:N/MAC:H/MPR:N/MUI:N/MS:U/MC:H/MI:H/MA:H",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":H","/I",":H","/A",":H","/CR",":X","/IR",":X","/AR",":X","/MAV",":N","/MAC",":H","/MPR",":N","/ MUI",":N","/MS",":U","/MC",":H","/MI",":H","/MA",":H"]})]}),"\n",(0,a.jsx)(i.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,a.jsx)(i.p,{children:"Insecure deserialization is a well-known yet not commonly occurring vulnerability in which an attacker inserts malicious objects into a web application. This allows them to inflict denial-of-service (DoS) attacks, remote code execution attacks, SQL injections, Path Traversal, and Authentication Bypasses."}),"\n",(0,a.jsx)(i.p,{children:"Deserialization attacks are a significant threat and can have severe consequences for businesses and customers. Potential vulnerabilities have been identified in the most popular programming languages, including Java, Python, .NET, PHP, Node.js, and Ruby."}),"\n",(0,a.jsx)(i.p,{children:"Insecure deserialization has been ranked as #8 on the OWASP Top Ten List of web applications most critical security risks since 2017, along with other risks such as an injection vulnerability. In addition, it is recognized as one of the first steps that software development organizations need to take to ensure more secure coding."}),"\n",(0,a.jsx)(i.h2,{id:"attack-examples",children:"Attack examples"}),"\n",(0,a.jsx)(i.p,{children:"Insecure deserialization attacks are often seen as challenging to execute and thus deemed not typical, affecting as low as 1% of applications. Yet, due to a large number of attacks, an application that can be subject to this attack shouldn't be underestimated."}),"\n",(0,a.jsx)(i.p,{children:"The most typical example of an insecure deserialization vulnerability is when an attacker loads untrusted code into a serialized object and then forwards it to the web application. The application will deserialize the malicious input if there are no checks, allowing it to access even more of its parts. That is how it makes possible additional attacks that eventually may cause serious privacy vulnerability for the application's user base. Insecure deserialization is thus sometimes referred to as an 'object injection vulnerability."}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.em,{children:"OWASP Insecure Deserialization Cheat Sheet"})," contains some common attack examples:"]}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:["A set of Spring Boot microservices is called in a React application. To make their code immutable, the programmers serialized user states, which are passed back and forth with each request. An attacker abuses the ",(0,a.jsx)(i.code,{children:"R00"})," Java object signature and, by employing the Java Serial Killer tool, performs remote code execution on the application server."]}),"\n",(0,a.jsx)(i.li,{children:"PHP object serialization is used for a PHP forum to save a super cookie loaded with data. It contains the user ID, role, password hash, and other states. An attacker modifies the serialized object to obtain admin privileges and tamper with the data."}),"\n"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{children:'a:4:{i:0;i:132;i:1;s:7:"Mallory";i:2;s:4:"user";  \ni:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";} \n'})}),"\n",(0,a.jsx)(i.p,{children:"The attacker changes the serialized object to give themselves admin privileges:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{children:'a:4:{i:0;i:1;i:1;s:5:"Alice";i:2;s:5:"admin";  \ni:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";}\n'})}),"\n",(0,a.jsx)(i.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,a.jsx)(i.p,{children:"To protect your web application from insecure deserialization, it is crucial never to pass a serialized object manipulated with untrusted input by the user to the deserialize function. The reason is that if you do so, an untrusted user would be able to manipulate the object and can send it directly to the PHP deserialize function."}),"\n",(0,a.jsx)(i.p,{children:"As an example how a serialized PHP object looks like, see the code block below:"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{alt:"Insecure_Deserialization_Code",src:t(16588).Z+"",width:"1448",height:"81"})}),"\n",(0,a.jsx)(i.p,{children:"Suppose you need to pass serialized data between the web application and a user. In that case, you can use a secure and lightweight data-interchange format like JSON (JavaScript Object Notation) instead of deserializing."}),"\n",(0,a.jsx)(i.p,{children:"The OWASP notes that the best way to prevent insecure deserialization attacks is never to accept serialized objects from untrusted users. Alternatively, you can use serialization tools that allow only primitive data types."}),"\n",(0,a.jsx)(i.p,{children:"In case you have to accept serialized objects, here are some tips for stopping insecure deserialization:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:"Introduce digital signatures and other integrity checks to stop malicious object creation or other data interfering."}),"\n",(0,a.jsx)(i.li,{children:"Run deserialization code in low privilege environments."}),"\n",(0,a.jsx)(i.li,{children:"Keep a log with deserialization exceptions and failures."}),"\n",(0,a.jsx)(i.li,{children:"Execute strict constraints for the deserialization processes before object creation."}),"\n",(0,a.jsx)(i.li,{children:"Limit and check all incoming and outgoing network activity from deserialization containers and servers."}),"\n",(0,a.jsx)(i.li,{children:"Keep tabs on deserialization activities to identify in case there is constant deserialization by a user."}),"\n",(0,a.jsx)(i.li,{children:"Use deserialization methods like JSON, XML, and YAML that are language-agnostic."}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"test-for-insecure-deserialization",children:"Test for insecure deserialization"}),"\n",(0,a.jsx)(i.p,{children:'You can check your application manually from the source code site and in the running state for insecure deserialization testing. You can also use a static code analysis tool. However, it would require access to your code and only see the "theoretical" view of your application in a non-executed way.'}),"\n",(0,a.jsx)(i.p,{children:"If you want to test your executed, running application, the best approach is to use a dynamic application security testing tool. It can automatically scan your web application or API."}),"\n",(0,a.jsxs)(i.p,{children:["To test if your web application is vulnerable to insecure deserialization, you can run an invasive free scan through the ",(0,a.jsx)(i.a,{href:"https://crashtest.cloud/registration?utm_source=blog&utm_medium=referral&utm_campaign=blog_reg",children:"Vulnerability Testing Software"}),"."]}),"\n",(0,a.jsxs)(i.p,{children:["The content of this section is ",(0,a.jsx)(i.a,{href:"https://creativecommons.org/licenses/by-sa/4.0/",children:"Creative Commons Attribution-ShareAlike v4.0"}),"."]})]})}function u(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},16588:(e,i,t)=>{t.d(i,{Z:()=>a});const a=t.p+"assets/images/Insecure_Deserialization_Code-dc70fbbf259a8ec434cd2d408c283e38.png"},79645:(e,i,t)=>{t.d(i,{Z:()=>a});const a=t.p+"assets/images/Security_Assessment_InsecureDeserialization-11301e3763a15947ee6575bc2dea625a.png"},11151:(e,i,t)=>{t.d(i,{Z:()=>o,a:()=>r});var a=t(67294);const s={},n=a.createContext(s);function r(e){const i=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(n.Provider,{value:i},e.children)}}}]);