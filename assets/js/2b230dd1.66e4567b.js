"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[31575],{32397:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var a=i(85893),t=i(11151);const s={title:"Create a Dynamic Analysis of an API with the REST API",slug:"/r/Use_the_REST_API_to_Create_a_Dynamic_Analysis_of_an_API"},c=void 0,o={id:"guides/apis/rest_apis/dynamic_rest_api/dynamic_api_create_api_scan",title:"Create a Dynamic Analysis of an API with the REST API",description:"You can use the Dynamic Analysis API to create an analysis of a REST API. You can also use it to upload a specification to Veracode and get details about an uploaded specification.",source:"@site/docs/guides/14_apis/04_rest_apis/05_dynamic_rest_api/01_dynamic_api_create_api_scan.md",sourceDirName:"guides/14_apis/04_rest_apis/05_dynamic_rest_api",slug:"/r/Use_the_REST_API_to_Create_a_Dynamic_Analysis_of_an_API",permalink:"/km-docusaurus-test/r/Use_the_REST_API_to_Create_a_Dynamic_Analysis_of_an_API",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Create a Dynamic Analysis of an API with the REST API",slug:"/r/Use_the_REST_API_to_Create_a_Dynamic_Analysis_of_an_API"},sidebar:"tutorialSidebar",previous:{title:"Dynamic Analysis REST API",permalink:"/km-docusaurus-test/r/c_dynamic_intro"},next:{title:"Update a Dynamic Analysis of an API with the REST API",permalink:"/km-docusaurus-test/r/Use_the_REST_API_to_Update_a_Dynamic_Analysis_of_an_API"}},r={},l=[{value:"Upload an API specification",id:"upload-an-api-specification",level:2},{value:"Get API specification details",id:"get-api-specification-details",level:2},{value:"Create a Dynamic Analysis",id:"create-a-dynamic-analysis",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"You can use the Dynamic Analysis API to create an analysis of a REST API. You can also use it to upload a specification to Veracode and get details about an uploaded specification."}),"\n",(0,a.jsx)(n.h2,{id:"upload-an-api-specification",children:"Upload an API specification"}),"\n",(0,a.jsxs)(n.p,{children:["You can upload an API specification ",(0,a.jsx)(n.a,{href:"/km-docusaurus-test/r/Manage_API_Specifications_in_the_Veracode_Platform",children:"in the Veracode Platform"})," or with the REST API. The specification must be valid JSON or YAML."]}),"\n",(0,a.jsxs)(n.p,{children:["After you upload a specification, Veracode assigns it a unique ID. You specify the ID when you send a request to create or update a Dynamic Analysis scan of an API, or to ",(0,a.jsx)(n.a,{href:"#get-api-specification-details",children:"get detailed information"})," about your uploaded specifications."]}),"\n",(0,a.jsx)(n.p,{children:"To upload an API specification, send the following request:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'http --form --auth-type=veracode_hmac POST "https://api.veracode.com/was/configservice/v1/api_specifications?spec_name={spec_name}" file@{API_specification_file.json}\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"spec_name"})," is optional. You can include it to specify a custom name, such as ",(0,a.jsx)(n.code,{children:"My Specification"}),". If you do not include it, the request applies the filename of your specification file. You can also upload a file with a tool such as ",(0,a.jsx)(n.a,{href:"https://www.postman.com/",children:"Postman"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["In the following request body example, ",(0,a.jsx)(n.code,{children:"file_name"})," specifies the specification file to upload and ",(0,a.jsx)(n.code,{children:"spec_name"})," specifies the name to apply to the specification file during the upload."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'HTTP/1.1 200 OK\nAccess-Control-Expose-Headers: X-Internal-User, location\nCF-Cache-Status: DYNAMIC\nCF-RAY: 7ef81ee30b33351c-SMF\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nConnection: keep-alive\nContent-Encoding: gzip\nContent-Type: application/json\nDate: Mon, 31 Jul 2023 19:06:49 GMT\nExpires: 0\nPragma: no-cache\nServer: cloudflare\nSet-Cookie: path=/; domain=.veracode.com; HttpOnly; Secure; SameSite=None\nStrict-Transport-Security: max-age=31536000 ; includeSubDomains\nTransfer-Encoding: chunked\nX-CONVERSATION-ID: "00000000-0000-0000-0000-000000000004"\nX-Content-Type-Options: nosniff\nX-Frame-Options: DENY\nX-XSS-Protection: 1; mode=block\n\n{\n"capabilities": [],\n"endpoint_count": 43,\n// highlight-next-line\n"file_name": "API_specification_file.json",\n"modified_by_user": "username",\n"modified_date_time": "2023-07-31T19:06:49.132Z[UTC]",\n"org": "90999",\n"spec_id": "ID_of_My_Spec",\n// highlight-next-line\n"spec_name": "My_API_Spec.json",\n"spec_type": "OPEN_API_V3",\n"uploaded_by_user": "username",\n"uploaded_date_time": "2023-07-31T19:06:49.071Z[UTC]",\n"visibility": {\n"setup_type": "SEC_LEADS_ONLY",\n"team_identifiers": []\n}\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"get-api-specification-details",children:"Get API specification details"}),"\n",(0,a.jsxs)(n.p,{children:["You can retrieve detailed information about your ",(0,a.jsx)(n.a,{href:"#upload-api-specifications",children:"uploaded API specifications"}),". You can also search for specifications by name."]}),"\n",(0,a.jsx)(n.p,{children:"To get a detailed list of all API specifications for your organization, send the following request:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'http --auth-type=veracode_hmac GET "https://api.veracode.com/was/configservice/v1/api_specifications"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["In the response, ",(0,a.jsx)(n.code,{children:"spec_id"})," is the ID of the specification and ",(0,a.jsx)(n.code,{children:"spec_name"})," is the name you entered when you uploaded the specification."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'"_embedded": {\n        "api_specs": [\n            {\n                "org": "72529",\n                // highlight-next-line\n                "spec_id": "ID_of_My_Spec",\n                "spec_name": "My API Specification",\n                "file_name": "my_api_spec.yaml",\n                "spec_type": "OPEN_API_V2",\n                "endpoint_count": 54,\n                "servers": [\n                    {\n                        "url": "https://api.veracode.com/was/configservice/v1"\n                    }\n                ],\n                "uploaded_date_time": "2023-05-19T13:00:46Z[UTC]",\n                "uploaded_by_user": "user",\n                "modified_date_time": "2023-05-19T13:00:46Z[UTC]",\n                "modified_by_user": "user",\n                "visibility": {\n                    "setup_type": "SEC_LEADS_ONLY",\n                    "team_identifiers": []\n                },\n                "capabilities": [\n                    "delete_api_specification",\n                    "update_api_specification",\n                    "update_team_visibility"\n                ]\n            },\n'})}),"\n",(0,a.jsxs)(n.p,{children:["To retrieve an API specification by ",(0,a.jsx)(n.code,{children:"spec_id"}),", send the following request:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'http --auth-type=veracode_hmac GET "https://api.veracode.com/was/configservice/v1/api_specifications/{spec_id}"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["To retrieve an API specification by ",(0,a.jsx)(n.code,{children:"spec_name"}),", send the following request:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'http --auth-type=veracode_hmac GET "https://api.veracode.com/was/configservice/v1/api_specifications?spec_name={spec_name}"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-dynamic-analysis",children:"Create a Dynamic Analysis"}),"\n",(0,a.jsx)(n.p,{children:"The Dynamic Analysis scans the endpoints in an uploaded API specification to identify vulnerabilities."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Before you begin:"})}),"\n",(0,a.jsxs)(n.p,{children:["Ensure you have the ",(0,a.jsx)(n.a,{href:"#get-api-specification-details",children:"ID of the API specification"})," you want to use for the scan. If you have not uploaded the specification to Veracode, you can upload it on the ",(0,a.jsxs)(n.a,{href:"/km-docusaurus-test/r/Manage_API_Specifications_in_the_Veracode_Platform",children:[(0,a.jsx)(n.strong,{children:"API Specification Management"})," tab"]})," in the Veracode Platform or with the ",(0,a.jsx)(n.a,{href:"#upload-an-api-specification",children:"REST API"}),"."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"To complete this task:"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Enter values for the ",(0,a.jsx)(n.code,{children:"scan_config_request"})," and ",(0,a.jsx)(n.code,{children:"schedule"})," properties in your JSON payload. If you are using ",(0,a.jsx)(n.a,{href:"/km-docusaurus-test/r/t_dynamic_ISM",children:"Internal Scanning Management (ISM)"}),", also enter values for the ",(0,a.jsx)(n.code,{children:"internal_scan_configuration"})," property."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Send the following request:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'http --auth-type=veracode_hmac POST "https://api.veracode.com/was/configservice/v1/analyses?scan_type=API_SCAN" < input.json\n'})}),"\n",(0,a.jsx)(n.p,{children:"The following example payload specifies to:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Use HTTP header ",(0,a.jsx)(n.a,{href:"/km-docusaurus-test/r/API_Scanning_Authentication_Methods",children:"authentication"}),", as specified for the ",(0,a.jsx)(n.code,{children:"authtype"})," property, to access the endpoints in the API specification."]}),"\n",(0,a.jsxs)(n.li,{children:["Scan the endpoints in the API specification specified for the ",(0,a.jsx)(n.code,{children:"spec_id"})," property."]}),"\n",(0,a.jsxs)(n.li,{children:["Start scanning immediately, as specified for the ",(0,a.jsx)(n.code,{children:"schedule"})," property, and run for two days."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'   {\n     "name": "Scan-API-with-Header-Authentication",\n     "scans": [\n       {\n         "action_type": "ADD",\n         "request_id": "0",\n         "scan_config_request": {\n           "target_url": {\n             "url": "https://www.example.com"\n           },\n           "auth_configuration": {\n             "authentications": {\n               "HEADER": {\n                 "authtype": "HEADER",\n                 "headers": [\n                   {\n                     "key": "Authorization",\n                     "value": "Token {your_token}",\n                     "url": ""\n                   }\n                 ]\n               }\n             }\n           },\n           "api_scan_setting": {\n             "spec_id": "{ID_of_your_API_specification}"\n           }\n         },\n         "internal_scan_configuration": {\n           "enabled": false,\n           "endpoint_id": "",\n           "gateway_id": ""\n         }\n       }\n     ],\n     "visibility": {\n       "setup_type": "SEC_LEADS_ONLY",\n       "team_identifiers": []\n     },\n     "schedule": {\n       "start_date": "2023-04-21T09:46:19-04:00",\n       "now": true,\n       "duration": {\n         "length": 2,\n         "unit": "DAY"\n       },\n       "schedule_status": "ACTIVE"\n     }\n   }\n'})}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>c});var a=i(67294);const t={},s=a.createContext(t);function c(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);