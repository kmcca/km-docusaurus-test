"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[25018],{36901:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>d});var o=i(85893),r=i(11151);const t={title:"Go packaging",slug:"/r/compilation_go"},s=void 0,a={id:"guides/packaging/go",title:"Go packaging",description:"Your Go applications must meet specific compilation requirements before you can submit them for scanning.",source:"@site/docs/guides/03_packaging/12_go.md",sourceDirName:"guides/03_packaging",slug:"/r/compilation_go",permalink:"/km-docusaurus-test/r/compilation_go",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{title:"Go packaging",slug:"/r/compilation_go"},sidebar:"tutorialSidebar",previous:{title:"Dart and Flutter packaging",permalink:"/km-docusaurus-test/r/Dart_and_Flutter_Application_Packaging"},next:{title:"Groovy packaging",permalink:"/km-docusaurus-test/r/c_compilation_groovy"}},c={},d=[{value:"Supported Go versions",id:"supported-go-versions",level:2},{value:"Supported Go frameworks and libraries",id:"supported-go-frameworks-and-libraries",level:2},{value:"Packaging guidance for Go",id:"packaging-guidance-for-go",level:2},{value:"Software Composition Analysis requirements",id:"software-composition-analysis-requirements",level:2},{value:"Upload requirements",id:"upload-requirements",level:2},{value:"Configuration for different structures",id:"configuration-for-different-structures",level:2},{value:"Details and troubleshooting",id:"details-and-troubleshooting",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Your Go applications must meet specific compilation requirements before you can submit them for scanning."}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"/km-docusaurus-test/r/r_supported_table",children:"Supported languages and platforms"})," for instructions for other platforms."]}),"\n",(0,o.jsxs)(n.p,{children:["You can analyze applications using Veracode Static Analysis or Veracode Software Composition Analysis (SCA) upload and scan, if licensed. For SCA agent-based scan requirements, see ",(0,o.jsx)(n.a,{href:"/km-docusaurus-test/r/Using_Veracode_SCA_with_Programming_Languages",children:"Using Veracode SCA with Programming Languages"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"supported-go-versions",children:"Supported Go versions"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Language"}),(0,o.jsx)(n.th,{children:"Version"})]})}),(0,o.jsx)(n.tbody,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Go"}),(0,o.jsx)(n.td,{children:"1.21 and earlier"})]})})]}),"\n",(0,o.jsx)(n.h2,{id:"supported-go-frameworks-and-libraries",children:"Supported Go frameworks and libraries"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Framework/Library"}),(0,o.jsx)(n.th,{children:"Notes"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Gorilla"}),(0,o.jsx)(n.td,{children:"Includes support for mux, handlers, HTTP, session, and additional Gorilla components"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Gin Web Framework (Gin-Gonic)"}),(0,o.jsx)(n.td,{children:"1.7.x"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"AWS SDK for Go"}),(0,o.jsx)(n.td,{children:"v2"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"packaging-guidance-for-go",children:"Packaging guidance for Go"}),"\n",(0,o.jsx)(n.p,{children:"Veracode uses functionality in the standard Go compiler when analyzing applications, and requires that the application is packaged in a structure that can be compiled. Package the source directory for a single compilable Go executable as a compressed ZIP archive, and structure it using these rules:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The ZIP archive must contain a single directory."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["The top-level directory must include a GO file that contains a ",(0,o.jsx)(n.code,{children:"main()"})," call, in addition to any other Go source files that the main package uses. For information on specifying a different location for the ",(0,o.jsx)(n.code,{children:"main()"})," call, see [Configuration for Different Structures](#Configuration for different structures)."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Veracode uses the vendoring functionality in Go to manage third-party libraries. When building an application with Go 1.11 or later, you can use the ",(0,o.jsx)(n.code,{children:"-mod=vendor"})," option, or run the ",(0,o.jsx)(n.code,{children:"go mod vendor"})," command to create the vendor directory."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["You must place any third-party libraries or other internal packages in a subdirectory named ",(0,o.jsx)(n.code,{children:"vendor"}),". For example: ",(0,o.jsx)(n.code,{children:"vendor/github.com/my_org/my_application"})]}),"\n",(0,o.jsx)(n.li,{children:"Any dependencies that the application uses must be in the vendor subdirectory."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["For more information, see ",(0,o.jsx)(n.a,{href:"https://github.com/golang/go/wiki/Modules#how-do-i-use-vendoring-with-modules-is-vendoring-going-away",children:"How do I use vendoring with modules?"})]}),"\n",(0,o.jsxs)(n.p,{children:["If the top-level directory contains a go.mod file, Veracode Static Analysis uses the ",(0,o.jsx)(n.code,{children:"module"})," directive to detect the module path. For example, the ",(0,o.jsx)(n.code,{children:"mymod"})," folder in your application might include a ",(0,o.jsx)(n.code,{children:"go.mod"})," file that contains module ",(0,o.jsx)(n.code,{children:"github.com/user/mymod"}),". You can import ",(0,o.jsx)(n.code,{children:"github.com/user/mymod/stringutil"})," even if you archive only the ",(0,o.jsx)(n.code,{children:"mymod"})," folder, instead of the entire path ",(0,o.jsx)(n.code,{children:"github.com/user/mymod"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["For more information, see the ",(0,o.jsx)(n.a,{href:"https://github.com/golang/go/wiki/Modules#gomod",children:"go.mod"})," Wiki page."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The application must not include any cgo dependencies or build tags that restrict the application to running only on a specific operating system."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Any packages that the application uses that are specific to the application must be contained in a subdirectory inside the app directory."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"This example shows the structure of the submitted source files:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"app.zip\n|__ app/\n    |-- main.go\n    |-- [other *.go files in package main]\n    |-- [go.mod if used]\n    |__ applicationpkg1/\n        |-- [application package 1 *.go files]\n    |__ applicationpkg2/\n        |-- [application package 2 *.go files]\n    |__ vendor/ [first- and third-party dependencies go in this folder]\n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"software-composition-analysis-requirements",children:"Software Composition Analysis requirements"}),"\n",(0,o.jsx)(n.p,{children:"If using Veracode Software Composition Analysis, follow the requirements for your package manager:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Dep"})}),"\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"gopkg.lock"})," in the root of your ZIP archive."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Glide"})}),"\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"glide.lock"})," in the root of your ZIP archive."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Go modules"})}),"\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"go.sum"})," file in the top-level directory of your archive.\nTo have SCA use the content in the ",(0,o.jsx)(n.code,{children:"vendor"})," directory to exclude non-vendored dependencies from scan results, Veracode recommends Go version 1.14 or later.\nTo create the ",(0,o.jsx)(n.code,{children:"vendor"})," directory, use the ",(0,o.jsx)(n.code,{children:"-mod=vendor"})," option or run this command: ",(0,o.jsx)(n.code,{children:"go mod vendor"}),". For more information, see the ",(0,o.jsx)(n.a,{href:"https://github.com/golang/go/wiki/Modules#how-do-i-use-vendoring-with-modules-is-vendoring-going-away",children:"Go documentation"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Godep"})}),"\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"godeps/godeps.lock"})," in the root of your ZIP archive."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Govendor"})}),"\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"vendor/vendor.json"})," in the root of your ZIP archive."]}),"\n",(0,o.jsx)(n.h2,{id:"upload-requirements",children:"Upload requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"An upload must only contain one Go module."}),"\n",(0,o.jsx)(n.li,{children:"You must split a multi-module project into separate uploads."}),"\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"go.mod"})," file for a module must be in the top-level directory of your archive."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Veracode does not support uploading a source repository that includes the source for multiple discrete Go executables or multiple modules."}),"\n",(0,o.jsxs)(n.p,{children:["Veracode cannot analyze a Go module or package without a ",(0,o.jsx)(n.code,{children:"main()"})," function."]}),"\n",(0,o.jsx)("a",{name:"go_diff_structures"}),"\n",(0,o.jsx)(n.h2,{id:"configuration-for-different-structures",children:"Configuration for different structures"}),"\n",(0,o.jsx)(n.p,{children:"If the application you want to analyze has a package structure that does not match the upload requirements, you can include a file that describes the structure of the application."}),"\n",(0,o.jsxs)(n.p,{children:["In the root of the directory that you compress to form the ZIP archive, include a JSON file named ",(0,o.jsx)(n.code,{children:"veracode.json"}),", with these optional properties:"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MainRoot"})}),"\n",(0,o.jsxs)(n.p,{children:["Describes the import path relative to the enclosing directory where the main package is located. For example, if the root folder is named ",(0,o.jsx)(n.code,{children:"project"}),", and the main file is in ",(0,o.jsx)(n.code,{children:"project/cmd/main"}),", then the value for this configuration field is ",(0,o.jsx)(n.code,{children:"cmd/main"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MainPkgName"})}),"\n",(0,o.jsxs)(n.p,{children:["Describes if the name of the package containing the ",(0,o.jsx)(n.code,{children:"main()"})," function for the application is something other than ",(0,o.jsx)(n.code,{children:"main"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"FirstParty"})}),"\n",(0,o.jsx)(n.p,{children:"Describes an array of import paths for first-party code that is located in the vendor directory."}),"\n",(0,o.jsxs)(n.p,{children:["This example shows of the ",(0,o.jsx)(n.code,{children:"veracode.json"})," configuration file:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'{\n    "MainRoot": "cmd/app1",\n    "MainPkgName": "app1",\n    "FirstParty": [\n        "github.company.com"\n    ]\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"This example shows the application structure that uses a configuration file:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"app.zip\n|__ app/\n    |-- veracode.json [configuration file describing the structure]\n    |__ cmd/\n        |__ app1\n            |-- main.go\n    |__ vendor/ [first- and third-party dependencies go in this folder]\n        |__ golang.org/\n        |__ gopkg.in/\n        |__ github.com/\n            |__ my_company/\n                |__ firstpartypkg1/\n                |__ firstpartypkg2/\n            |__ 3rdparty\n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"details-and-troubleshooting",children:"Details and troubleshooting"}),"\n",(0,o.jsxs)(n.p,{children:["Veracode uses the Go compiler to generate syntax trees to analyze the applications. The submitted archive is unzipped to an empty workspace directory. The ",(0,o.jsx)(n.code,{children:"$GOPATH"})," environment variable is set to this workspace. Each directory in this workspace is scanned for a GO file containing a ",(0,o.jsx)(n.code,{children:"main()"})," function, to identify the main package to compile the application."]}),"\n",(0,o.jsxs)(n.p,{children:["You can validate that the application compiles by running the ",(0,o.jsx)(n.a,{href:"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies",children:"go build"})," command after unzipping the file into a blank directory, or by running the ",(0,o.jsx)(n.a,{href:"https://golang.org/cmd/vet/",children:"go vet"})," command on it to identify any issues with the structure of the directory and package layout. If the application is unable to compile after being unzipped into a blank directory, Veracode cannot analyze the application."]}),"\n",(0,o.jsxs)(n.p,{children:["To better understand the use of the vendor folder, review the ",(0,o.jsx)(n.a,{href:"https://golang.org/cmd/go/",children:"Go documentation"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"If your application includes vendor dependencies that contain code in languages other than Go, you should remove them with this command:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"find /<path>/app/vendor -type f -not -name '*.go' -delete"})}),"\n",(0,o.jsx)(n.p,{children:"Veracode scans only GO files that have the GO extension."}),"\n",(0,o.jsxs)(n.p,{children:["When creating an archive of a Go application on macOS, the folder compression process creates hidden ",(0,o.jsx)(n.code,{children:"__MACOSX"})," resource fork files that you must remove. To remove the hidden resource fork files:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Run ",(0,o.jsx)(n.code,{children:"zipinfo my.zip"})," on the Go application archive to view a list of its files."]}),"\n",(0,o.jsx)(n.li,{children:"Review the list of files to verify that all resource fork files are removed."}),"\n",(0,o.jsxs)(n.li,{children:["Remove resource fork files from an existing archive on macOS using this command: ",(0,o.jsx)(n.code,{children:'zip -d my.zip "__MACOSX/*"'})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>s});var o=i(67294);const r={},t=o.createContext(r);function s(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);