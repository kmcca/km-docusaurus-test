"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[23299],{84308:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var t=n(85893),i=n(11151);const o={title:"Enable secure cookies",slug:"/r/enable-secure-cookies"},r=void 0,a={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/enable-secure-cookies",title:"Enable secure cookies",description:"You can transfer cookies that are not marked as secure over an unencrypted connection. A man-in-the-middle attack can be used to get the contents of these cookies.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/06_enable-secure-cookies.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/enable-secure-cookies",permalink:"/km-docusaurus-test/r/enable-secure-cookies",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Enable secure cookies",slug:"/r/enable-secure-cookies"},sidebar:"tutorialSidebar",previous:{title:"Enable missing SSL CAA records",permalink:"/km-docusaurus-test/r/enable-missing-ssl-caa-record"},next:{title:"Configure secure TLS",permalink:"/km-docusaurus-test/r/secure-tls-configuration"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"PHP",id:"php",level:3},{value:"Django",id:"django",level:3}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"You can transfer cookies that are not marked as secure over an unencrypted connection. A man-in-the-middle attack can be used to get the contents of these cookies."}),"\n",(0,t.jsx)(s.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Security_Assessment_EnableSecureCookies",src:n(34033).Z+"",width:"907",height:"332"})}),"\n",(0,t.jsxs)(s.p,{children:["CVSS vector:  ",(0,t.jsxs)(s.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":L","/I",":L","/A",":N"]})]}),"\n",(0,t.jsx)(s.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,t.jsx)(s.p,{children:"Cookies that are not marked as secure can be transferred over an unencrypted connection. A man-in-the-middle attack can be used to get the contents of these cookies."}),"\n",(0,t.jsx)(s.p,{children:"Local scripts can read cookies that are not marked as HTTP-only. In the case of a Cross-Site-Scripting (XSS) attack, an attacker can read these cookies."}),"\n",(0,t.jsx)(s.p,{children:"Think of enabling both settings for all cookies depending on the cookie content. This is especially important for session cookies."}),"\n",(0,t.jsx)(s.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,t.jsx)(s.p,{children:"To set cookies to secure an HTTP-only, you need to configure the web framework which issues the cookies. Follow these guides for the correct settings:"}),"\n",(0,t.jsx)(s.h3,{id:"php",children:"PHP"}),"\n",(0,t.jsx)(s.p,{children:"In PHP, configure the cookie settings for all delivered websites. Set the following in your /etc/php/php.ini file:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"session.cookie_secure = 1  \nsession.cookie_httponly = 1\n"})}),"\n",(0,t.jsx)(s.h3,{id:"django",children:"Django"}),"\n",(0,t.jsx)(s.p,{children:"In Django, make the following cookie settings in your project configuration file:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"SESSION_COOKIE_HTTPONLY=true  \nSESSION_COOKIE_SECURE=true\n"})})]})}function u(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},34033:(e,s,n)=>{n.d(s,{Z:()=>t});const t=n.p+"assets/images/Security_Assessment_IncreaseTLSKeySize-e8b60f72154550155e179584ceb5f1ee.png"},11151:(e,s,n)=>{n.d(s,{Z:()=>a,a:()=>r});var t=n(67294);const i={},o=t.createContext(i);function r(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);