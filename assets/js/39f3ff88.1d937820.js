"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[32082],{61711:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=t(85893),n=t(11151);const i={title:"Configure secure TLS",slug:"/r/secure-tls-configuration"},o=void 0,c={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/secure-tls-configuration",title:"Configure secure TLS",description:"A correctly configured TLS encryption ensures that your users only get content from your web application that has not been tampered with and cannot be eavesdropped on. Learn here how you can secure your TLS configuration.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/07_secure-tls-configuration.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/secure-tls-configuration",permalink:"/km-docusaurus-test/r/secure-tls-configuration",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Configure secure TLS",slug:"/r/secure-tls-configuration"},sidebar:"tutorialSidebar",previous:{title:"Enable secure cookies",permalink:"/km-docusaurus-test/r/enable-secure-cookies"},next:{title:"Renew TLS certificates",permalink:"/km-docusaurus-test/r/renew-tls-certificates"}},a={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"About TLS",id:"about-tls",level:2},{value:"Check TLS security settings for optimal security",id:"check-tls-security-settings-for-optimal-security",level:2},{value:"Secure a TLS configuration",id:"secure-a-tls-configuration",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Apache",id:"apache",level:3},{value:"Nginx",id:"nginx",level:3}];function u(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"A correctly configured TLS encryption ensures that your users only get content from your web application that has not been tampered with and cannot be eavesdropped on. Learn here how you can secure your TLS configuration."}),"\n",(0,r.jsx)(s.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,r.jsx)(s.p,{children:"Based on the specific cipher suite, the values can differ from one to another. For the exact value of each cipher suite, see the table below."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Security_Assessment_TLS_Configuration-1",src:t(72122).Z+"",width:"907",height:"332"})}),"\n",(0,r.jsxs)(s.p,{children:["CVSS vector: ",(0,r.jsxs)(s.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":L","/I",":L","/A",":N"]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Security_Assessment_TLS_TABLE-1",src:t(72742).Z+"",width:"1142",height:"895"})}),"\n",(0,r.jsx)(s.h2,{id:"about-tls",children:"About TLS"}),"\n",(0,r.jsx)(s.p,{children:"A correctly configured TLS encryption ensures that your users only get content from your web application. This means there is no unregulated tampering with the exchanged communication, and users cannot eavesdrop on through the Transport Layer Security protocol."}),"\n",(0,r.jsx)(s.p,{children:"It is paramount to configure the Transport Layer Security protocol correctly to ensure the real security of your systems. If this is not done, this may create a sense of security that is not backed in reality."}),"\n",(0,r.jsx)(s.p,{children:"One of the main aspects of TLS configuration is using suitable profiles. Internet organizations recommend profiles, and following them is a good practice."}),"\n",(0,r.jsx)(s.p,{children:"Legacy profiles for TLS 1.1 and 1.0 have been found to have a lot of vulnerabilities. You should set up a migration plan to replace them with new versions."}),"\n",(0,r.jsx)(s.h2,{id:"check-tls-security-settings-for-optimal-security",children:"Check TLS security settings for optimal security"}),"\n",(0,r.jsx)(s.p,{children:"In your TLS configuration, you should set the allowed Transport Layer Security protocol version and ciphers to the most up-to-date values, which are considered secure now."}),"\n",(0,r.jsx)(s.p,{children:"First and foremost, it is essential to disable all older versions of the Transport Layer Security protocol, such as TLS 1.1 and 1.0. It is also a good idea to disable features that have proven to be insecure. More specifically, it is best to disable insecure renegotiation, insecure protocol downgrade, record compression, export key generation, and support for SSL 2."}),"\n",(0,r.jsx)(s.p,{children:"As for TLS 1.3, it is advised not to use the zero round trip mode or 0-RTT. If it is enabled, clients can send data in a Transport Layer Security session before the complete TLS handshake. This can give way to replay attacks and other security vulnerabilities. So it is best to avoid 0-RTT mode unless application protocols have specific protection for replay attacks."}),"\n",(0,r.jsxs)(s.p,{children:["See the ",(0,r.jsx)(s.a,{href:"https://wiki.mozilla.org/Security/Server_Side_TLS",children:"TLS configuration proposal"})," offered by Mozilla or use the ",(0,r.jsx)(s.a,{href:"https://mozilla.github.io/server-side-tls/ssl-config-generator/",children:"SSL Config Generator"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"secure-a-tls-configuration",children:"Secure a TLS configuration"}),"\n",(0,r.jsxs)(s.p,{children:["For secure TLS configuration, it is crucial to use vital and ",(0,r.jsx)(s.a,{href:"/km-docusaurus-test/r/configure-trusted-certificates",children:"trusted certificates"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"Recommended server certificate configurations:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Opt-in for the latest SSL/TLS protocol. Currently, modern versions 1.3 or 1.2 of the Transport Layer Security protocol exist."}),"\n",(0,r.jsx)(s.li,{children:"Check if you have any intermediate certificates. If you do, install them on your server so browsers get a full certification path."}),"\n",(0,r.jsx)(s.li,{children:"Ensure that your certificate applies to all of your hostnames."}),"\n",(0,r.jsx)(s.li,{children:"Use TLS implementations with AES cipher** variants rather than older versions with weak ciphers like DES."}),"\n",(0,r.jsxs)(s.li,{children:["Opt-in for ",(0,r.jsx)(s.a,{href:"https://crashtest-security.com/harden-tls-session-resumption/",children:"TLS Session Resumption"})," to skip constant session key renegotiation."]}),"\n",(0,r.jsxs)(s.li,{children:["Enable Forward Secrecy (FS), also known as ",(0,r.jsx)(s.a,{href:"https://crashtest-security.com/enable-perfect-forward-secrecy/",children:"Perfect Forward Secrecy (PFS)"}),", to protect past session keys in case a private key is compromised."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.a,{href:"https://crashtest-security.com/configure-ssl-cipher-order/",children:"secure cipher suites"}),". Recommended cipher suite requirements are a minimum of 128-bit encryption."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,r.jsx)(s.p,{children:"To configure the SSL/TLS encryption for your Apache and Nginx web server."}),"\n",(0,r.jsx)(s.h3,{id:"apache",children:"Apache"}),"\n",(0,r.jsxs)(s.p,{children:["In the case of Apache, the SSL/TLS configuration is stored in ",(0,r.jsx)(s.code,{children:"/etc/apache2/mods-enabled/ssl.conf"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["If you use Let's Encrypt, the configuration may reside in ",(0,r.jsx)(s.code,{children:"/etc/letsencrypt/options-ssl-apache.conf"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"To enable only acceptable cipher suites with high encryption and current protocols set:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1  \nSSLCipherSuite          ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256  \nSSLHonorCipherOrder     on  \nSSLCompression          off\n"})}),"\n",(0,r.jsx)(s.p,{children:"Then it would be best if you reloaded the Apache server configuration for the new settings to take effect."}),"\n",(0,r.jsx)(s.p,{children:"Note that this action limits the eligible default cipher suites and protocol versions to recent Transport Layer Security versions, which might lead users with older browsers to lose access."}),"\n",(0,r.jsx)(s.h3,{id:"nginx",children:"Nginx"}),"\n",(0,r.jsxs)(s.p,{children:["For Nginx, update the configuration file which is usually located at ",(0,r.jsx)(s.code,{children:"/etc/nginx/nginx.conf"}),", ",(0,r.jsx)(s.code,{children:"/etc/nginx/sited-enabled/yoursite.com"})," (Ubuntu/Debian) or ",(0,r.jsx)(s.code,{children:"/etc/nginx/conf.d/nginx.conf"})," (RHEL/CentOS)."]}),"\n",(0,r.jsx)(s.p,{children:"Add the following directive to the server section:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"ssl_protocols TLSv1.2;  \nssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA38';  \nssl_prefer_server_ciphers on;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Restart the Nginx server. This limits the cipher suites and protocol version to recent Transport Layer Security versions. Users with older browsers may lose access."})]})}function d(e={}){const{wrapper:s}={...(0,n.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},72122:(e,s,t)=>{t.d(s,{Z:()=>r});const r=t.p+"assets/images/Security_Assessment_TLS_Configuration-1-7e49caad100322f70dc057c0a2f98a00.png"},72742:(e,s,t)=>{t.d(s,{Z:()=>r});const r=t.p+"assets/images/Security_Assessment_TLS_TABLE-1-8bdb9ca4bf427875ddd5772f631b4cd4.png"},11151:(e,s,t)=>{t.d(s,{Z:()=>c,a:()=>o});var r=t(67294);const n={},i=r.createContext(n);function o(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);