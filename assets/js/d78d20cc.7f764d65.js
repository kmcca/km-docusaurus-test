"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[42265],{34316:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var n=s(85893),i=s(11151);const a={title:"Prevent XML External Entity (XXE) processing attacks",slug:"/r/xxe-processing"},r=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_misc/xxe-processing",title:"Prevent XML External Entity (XXE) processing attacks",description:"Many older or poorly configured XML processors evaluate external entity references within XML documents.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/09_dast_essentials_misc/04_xxe-processing.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/09_dast_essentials_misc",slug:"/r/xxe-processing",permalink:"/km-docusaurus-test/r/xxe-processing",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Prevent XML External Entity (XXE) processing attacks",slug:"/r/xxe-processing"},sidebar:"tutorialSidebar",previous:{title:"Secure network services",permalink:"/km-docusaurus-test/r/insecure-network-services-open-port-scanner"},next:{title:"Prevent authentication and session management attacks",permalink:"/km-docusaurus-test/r/broken-authentication-and-session-management"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"What are XXE Attacks?",id:"what-are-xxe-attacks",level:3},{value:"How To Fix XXE Attacks?",id:"how-to-fix-xxe-attacks",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"Many older or poorly configured XML processors evaluate external entity references within XML documents."}),"\n",(0,n.jsx)(t.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Security_Assessment_XXE",src:s(49320).Z+"",width:"907",height:"332"})}),"\n",(0,n.jsxs)(t.p,{children:["CVSS vector:  ",(0,n.jsxs)(t.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",children:["AV",":N","/AC",":L","/PR",":N","/UI",":N","/S",":U","/C",":H","/I",":H","/A",":L","/CR",":H","/IR",":H","/AR",":H","/MAV",":N","/ MAC",":L","/MPR",":N","/MUI",":N","/MS",":U","/MC",":H","/MI",":H","/MA",":H"]})]}),"\n",(0,n.jsx)(t.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,n.jsx)(t.p,{children:"External entity profiles are defined by outside sources such as a file on a local computer or a web URL. Such entities ensure that the XML processor behaves consistently even when unexpected characters are parsed."}),"\n",(0,n.jsx)(t.p,{children:"External entities have various legitimate use cases:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Calling an XML document hosted locally to be used in another XML document"}),"\n",(0,n.jsx)(t.li,{children:"Dividing documents into smaller, logical units"}),"\n",(0,n.jsx)(t.li,{children:"Referring to the same entity framework multiple times without having to repeat the same element"}),"\n",(0,n.jsx)(t.li,{children:"Using external entity references with different encoding in the same document"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"If the parser that processes external entities is weakly configured, hackers can intercept data going to the server and inject malicious payloads. Attackers typically also exploit custom external entities to access sensitive data."}),"\n",(0,n.jsx)(t.h3,{id:"what-are-xxe-attacks",children:"What are XXE Attacks?"}),"\n",(0,n.jsx)(t.p,{children:"Some web applications include XML processors that evaluate untrusted external references within an XML file. These references enable attackers to use external parameter entities to disclose various configuration file information, which the attackers then exploit the system further."}),"\n",(0,n.jsx)(t.p,{children:"Since these attacks occur through parsing XML inputs in an application, attackers can leverage it to access other integrated systems, leading to application unavailability and loss of sensitive data. It is, therefore, prudent to understand the nature of these attacks and how they can be prevented."}),"\n",(0,n.jsx)(t.h2,{id:"how-to-fix-xxe-attacks",children:"How To Fix XXE Attacks?"}),"\n",(0,n.jsx)(t.p,{children:"An XXE vulnerability exists when a web application parses XML documents from an untrusted source. If the underlying XML parser accepts DTD, an attacker can manipulate the XML document to allow him to read files on the system. For example, the following code snippet shows a malicious XML document that forces the application to read sensitive files on the server."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-xml",children:'<?xml version="1.0" encoding="utf-8"?>  \n<!DOCTYPE credentials [  \n<!ELEMENT credentials ANY >  \n<!ELEMENT user ANY >  \n<!ENTITY user SYSTEM "file:///etc/passwd">]>  \n<credentials>  \n    <user>&user;</user>  \n    <pass>mypass</pass>  \n</credentials> \n'})}),"\n",(0,n.jsx)(t.p,{children:"A poorly configured XML parser would read the file specified in the DTD and possibly display it to the attacker. Therefore, to protect your web application from this attack, you can disable the entity loader for the XML parser, as the snippet shows below."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"libxml_disable_entity_loader(true); \n"})}),"\n",(0,n.jsx)(t.p,{children:"To disable the entity loader, it is recommended to use a local static DTD and remove any other DTD included in the XML document."})]})}function u(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},49320:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/Security_Assessment_New_XXE-124b4930839878fd54037ee234dee7dc.png"},11151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>r});var n=s(67294);const i={},a=n.createContext(i);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);