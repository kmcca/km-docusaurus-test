"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[93704],{15159:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var i=n(85893),s=n(11151);const a={title:"Prevent SSL renegotiation attacks",slug:"/r/secure-ssl-renegotiation"},r=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/secure-ssl-renegotiation",title:"Prevent SSL renegotiation attacks",description:"The renegotiation process of the SSL encryption is vulnerable. It allows two negotiations to be handled by different parties. This leaves your data vulnerable to Man-In-The-Middle attacks.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/30_secure-ssl-renegotiation.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/secure-ssl-renegotiation",permalink:"/km-docusaurus-test/r/secure-ssl-renegotiation",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:30,frontMatter:{title:"Prevent SSL renegotiation attacks",slug:"/r/secure-ssl-renegotiation"},sidebar:"tutorialSidebar",previous:{title:"Enable TLS_FALLBACK_SCSV",permalink:"/km-docusaurus-test/r/enable-tls_fallback_scsv"},next:{title:"Prevent CCS injection attacks",permalink:"/km-docusaurus-test/r/prevent-ccs-injection"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:3},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Disable renegotiation",id:"disable-renegotiation",level:2},{value:"Test for secure renegotiation",id:"test-for-secure-renegotiation",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"The renegotiation process of the SSL encryption is vulnerable. It allows two negotiations to be handled by different parties. This leaves your data vulnerable to Man-In-The-Middle attacks."}),"\n",(0,i.jsx)(t.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Security_Assessment_ SecureSSLRenegotiation",src:n(34253).Z+"",width:"907",height:"332"})}),"\n",(0,i.jsxs)(t.p,{children:["CVSS vector: ",(0,i.jsxs)(t.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?name=CVE-2009-3555&vector=(AV:N/AC:M/Au:N/C:N/I:P/A:P)",children:["AV",":N","/AC",":M","/AU",":N","/C",":N","/I",":P","/A",":P"]})]}),"\n",(0,i.jsx)(t.h3,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,i.jsx)(t.p,{children:"The negotiation process of the SSL encryption uses significantly more resources on the server than on the client. Therefore, if the client can initiate the renegotiation process, an attacker can render the server unavailable with a Denial of Service attack."}),"\n",(0,i.jsxs)(t.p,{children:["The SSL renegotiation flaw can affect different types of systems. It is essentially caused by a vulnerability in the client-initiated renegotiation of ",(0,i.jsx)(t.a,{href:"https://crashtest-security.com/ssl-scanner-tool-tls/",children:"SSL/TLS"})," for existing server connections."]}),"\n",(0,i.jsx)(t.p,{children:"Some of the symptoms of renegotiation issues include:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"It fails in the case of a virtual server processing SSL connections."}),"\n",(0,i.jsx)(t.li,{children:"There are BIG-IP system error messages logged about SSL handshake/renegotiation."}),"\n",(0,i.jsx)(t.li,{children:"The virtual server rejecting renegotiation attempts is logged in the SSL statistics."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"In a nutshell, the SSL communication or handshake process entails exchanging messages between the server and the client. They define the settings of the encrypted communication, including enabled cipher suites, protocol version, renegotiation security, and others."}),"\n",(0,i.jsx)(t.p,{children:"The SSL handshake contains components like ClientHello, ServerHello, server certificate, ServerHelloDone, ClientKeyExchange, ChangeCipherSpec, Finished, Renegotiated SSL sessions, and Renegotiation settings."}),"\n",(0,i.jsx)(t.p,{children:"The last two components relate to the SSL renegotiation. The initial handshake process can be renegotiated with different cryptographic parameters if necessary. The other options for a renegotiation setting include how the renegotiation requests are processed, period (renegotiation after a certain time period), size (after a certain amount of data), and max record delay (number of delayed records), among others."}),"\n",(0,i.jsx)(t.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,i.jsx)(t.p,{children:"As illustrated in the previous sections, insecure client-initiated SSL renegotiation poses a severe threat to your systems. The problem has been fixed in consecutive web server versions, such as the latest versions of Apache and Nginx. They do not allow client-initiated SSL renegotiation."}),"\n",(0,i.jsx)(t.p,{children:"This means that you always have to ensure that your web server is up-to-date. By doing this, you can provide the best current protection."}),"\n",(0,i.jsx)(t.p,{children:"To double-check that, you have to run:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"apt-get update; apt-get upgrade # Debian / Ubuntu  \nyum update                      # RHeL / CentOS  \npacman -Syu                     # Arch Linux\n"})}),"\n",(0,i.jsx)(t.h2,{id:"disable-renegotiation",children:"Disable renegotiation"}),"\n",(0,i.jsx)(t.p,{children:"You must manually disable these configuration options if your web server does not prevent client-initiated SSL renegotiation by default. The guiding principle is that only the server should be allowed to initiate a renegotiation of the SSL/TLS connection."}),"\n",(0,i.jsx)(t.p,{children:"In some cases, disabling a client renegotiation attempt may not be possible. Then it is crucial to set only secure renegotiation and define the number of possible SSL handshakes."}),"\n",(0,i.jsx)(t.h2,{id:"test-for-secure-renegotiation",children:"Test for secure renegotiation"}),"\n",(0,i.jsxs)(t.p,{children:["Do you know if your system or a specific application is vulnerable to the threat of client-initiated SSL renegotiation due to unpatched clients or other issues? You can run a non-invasive scan with ",(0,i.jsx)(t.a,{href:"https://crashtest.cloud/registration?utm_source=blog&utm_medium=referral&utm_campaign=blog_reg",children:"DAST Essentials"})," for free."]})]})}function u(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},34253:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/Security_Assessment_ SecureSSLRenegotiation-fe52c4a549187c3f4421090ffbeaf62d.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>r});var i=n(67294);const s={},a=i.createContext(s);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);