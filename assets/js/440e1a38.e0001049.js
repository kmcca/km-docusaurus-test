"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[54742],{51278:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var i=n(85893),s=n(11151);const r={title:"Configure trusted certificates",slug:"/r/configure-trusted-certificates"},c=void 0,a={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/configure-trusted-certificates",title:"Configure trusted certificates",description:"The X.509 certificate issued for this domain cannot be trusted. Therefore, clients such as browsers will show warnings or not be able to connect if they cannot trust the certificate. Read here how you can configure trusted certificates.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/03_configure-trusted-certificates.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/configure-trusted-certificates",permalink:"/km-docusaurus-test/r/configure-trusted-certificates",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Configure trusted certificates",slug:"/r/configure-trusted-certificates"},sidebar:"tutorialSidebar",previous:{title:"Certificate revocation",permalink:"/km-docusaurus-test/r/certificate-revocation"},next:{title:"Enable HTTP Strict Transport Security",permalink:"/km-docusaurus-test/r/enable-hsts"}},o={},d=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Let&#39;s Encrypt",id:"lets-encrypt",level:3},{value:"OpenSSL",id:"openssl",level:3},{value:"Apache",id:"apache",level:3},{value:"Nginx",id:"nginx",level:3}];function l(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"The X.509 certificate issued for this domain cannot be trusted. Therefore, clients such as browsers will show warnings or not be able to connect if they cannot trust the certificate. Read here how you can configure trusted certificates."}),"\n",(0,i.jsx)(t.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Security_Assessment_ConfigureTrustedCertificates",src:n(48274).Z+"",width:"907",height:"332"})}),"\n",(0,i.jsxs)(t.p,{children:["CVSS vector: ",(0,i.jsxs)(t.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",children:["AV",":N","/AC",":H","/PR",":N","/UI",":N","/S",":U","/C",":H","/I",":H","/A",":N"]})]}),"\n",(0,i.jsx)(t.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,i.jsx)(t.p,{children:"The X.509 certificate issued for this domain cannot be trusted. Clients such as browsers will show warnings or not be able to connect if they cannot trust the certificate. Trust issues arise if the common name in the certificate does not match the webserver domain, if the server does not provide an intermediate certificate or if the certificate is self-signed."}),"\n",(0,i.jsx)(t.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,i.jsx)(t.p,{children:"To issue a trusted certificate for your web application, the certificate needs to contain the correct information for your web application, such as the domain name as the certificate common name. The certificate must be signed by a certificate authority (CA) that the users' browser trusts. Finally, the webserver has to be configured to present the certificate on incoming HTTPS requests. Use one of the following guides to generate and use a trusted certificate."}),"\n",(0,i.jsx)(t.h3,{id:"lets-encrypt",children:"Let's Encrypt"}),"\n",(0,i.jsxs)(t.p,{children:["With Let's Encrypt, generating secure and trusted certificates is effortless. Install the ",(0,i.jsx)(t.a,{href:"https://certbot.eff.org/",children:"certbot"})," on the server which runs the web server and run the following command:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"certbot run -d [DOMAIN] --staple-ocsp --hsts\n"})}),"\n",(0,i.jsx)(t.h3,{id:"openssl",children:"OpenSSL"}),"\n",(0,i.jsx)(t.p,{children:"You can manually create a new, secure certificate and a certificate signing request (CSR). For example, to generate the certificate with a private key and the CSR run:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"openssl req -nodes -new -newkey rsa:2048 -sha256 -out csr.pem\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Answer all questions according to your needs. Then send the ",(0,i.jsx)(t.code,{children:"csr.pem"})," file to your CA. They will use this request to sign your certificate and provide you with the signed certificate. If the signed certificate is returned to you as ",(0,i.jsx)(t.code,{children:"new.crt"}),", you can combine the key and the signed certificate as follows:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"cp privkey.pem /etc/ssl/privkey.key  \ncp privkey.pem /etc/ssl/new.pem  \ncat new.crt >> /etc/ssl/new.pem\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The resulting ",(0,i.jsx)(t.code,{children:"new.pem"})," file can be copied to your webserver directory to be used in the web application. Suppose your certificate is signed by an intermediate certificate (which is not stored in your users' certificate storage) instead of a root certificate (which is stored in your users' certificate storage). In that case, you will need to bundle the intermediate certificate with your server certificate."]}),"\n",(0,i.jsx)(t.h3,{id:"apache",children:"Apache"}),"\n",(0,i.jsxs)(t.p,{children:["On Apache you need insert the certificate into the virtual host configuration ",(0,i.jsx)(t.code,{children:"in/etc/apache2/sites-enabled/domain.confor/etc/httpd/sites-enabled/domain.conf"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"<IfModule mod_ssl.c>  \n    SSLStaplingCache shmcb:/tmp/stapling_cache(128000)  \n    <VirtualHost *:443>  \n   \n            ServerAdmin webmaster@localhost  \n            ServerName example.com  \n            DocumentRoot /var/www  \n   \n            SSLEngine on  \n   \n            SSLCertificateFile /etc/ssl/new.pem  \n            SSLCertificateKeyFile /etc/ssl/privkey.key  \n    </VirtualHost>  \n</IfModule>\n"})}),"\n",(0,i.jsx)(t.h3,{id:"nginx",children:"Nginx"}),"\n",(0,i.jsxs)(t.p,{children:["For Nginx, update the configuration file which is usually located at ",(0,i.jsx)(t.code,{children:"/etc/nginx/nginx.conf"}),", ",(0,i.jsx)(t.code,{children:"/etc/nginx/sited-enabled/yoursite.com"})," (Ubuntu/Debian) or ",(0,i.jsx)(t.code,{children:"/etc/nginx/conf.d/nginx.conf"})," (RHEL/CentOS). Add the following directive to the server section:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"server {  \n  \n        listen 443;  \n        server_name example.org;  \n  \n        root /usr/share/nginx/www;  \n        index index.html index.htm;  \n  \n        ssl on;  \n        ssl_certificate /etc/ssl/new;  \n        ssl_certificate_key /etc/ssl/privkey.key;  \n}\n"})})]})}function u(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},48274:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/Security_Assessment_ConfigureTrustedCertificates-243dae95f388291f6823fedbc1928805.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>c});var i=n(67294);const s={},r=i.createContext(s);function c(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);