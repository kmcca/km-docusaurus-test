"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[60613],{93960:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var t=n(85893),i=n(11151);const a={title:"Prevent SSL CRIME attacks",slug:"/r/prevent-ssl-crime"},r=void 0,o={id:"guides/dynamic_analysis/dast_essentials/dast_essentials_tls_vulns/prevent-ssl-crime",title:"Prevent SSL CRIME attacks",description:"The CRIME (Compression Ratio Info-leak Made Easy) attack is a vulnerability in the SSL compression. The attack against secret web cookies sent over compressed HTTPS or SPDY connections leaves cookie data vulnerable to session hijacking.",source:"@site/docs/guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns/10_prevent-ssl-crime.md",sourceDirName:"guides/08_dynamic_analysis/15_dast_essentials/08_dast_essentials_tls_vulns",slug:"/r/prevent-ssl-crime",permalink:"/km-docusaurus-test/r/prevent-ssl-crime",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Prevent SSL CRIME attacks",slug:"/r/prevent-ssl-crime"},sidebar:"tutorialSidebar",previous:{title:"Prevent SSL LUCKY13 attacks",permalink:"/km-docusaurus-test/r/prevent-ssl-lucky13"},next:{title:"Prevent SSL BREACH attacks",permalink:"/km-docusaurus-test/r/prevent-ssl-breach"}},c={},l=[{value:"Security assessment",id:"security-assessment",level:2},{value:"Vulnerability information",id:"vulnerability-information",level:2},{value:"Prevent attacks",id:"prevent-attacks",level:2},{value:"Apache",id:"apache",level:3},{value:"Nginx",id:"nginx",level:3}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"The CRIME (Compression Ratio Info-leak Made Easy) attack is a vulnerability in the SSL compression. The attack against secret web cookies sent over compressed HTTPS or SPDY connections leaves cookie data vulnerable to session hijacking."}),"\n",(0,t.jsx)(s.h2,{id:"security-assessment",children:"Security assessment"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Security_Assessment_PreventSSLCRIME",src:n(79920).Z+"",width:"907",height:"332"})}),"\n",(0,t.jsxs)(s.p,{children:["CVSS vector: ",(0,t.jsxs)(s.a,{href:"https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?name=CVE-2012-4929&vector=(AV:N/AC:H/Au:N/C:P/I:N/A:N)",children:["AV",":N","/AC",":H","/AU",":N","/C",":P","/I",":N","/A",":N"]})]}),"\n",(0,t.jsx)(s.h2,{id:"vulnerability-information",children:"Vulnerability information"}),"\n",(0,t.jsx)(s.p,{children:"The CRIME attack can be executed against SSL/TLS protocols and the SPDY protocol to hijack users' session cookies while still authenticating to a website."}),"\n",(0,t.jsx)(s.p,{children:"This can be possible only if the protocols have enabled certain types of data compression methods. While compression can be pretty handy in general, it poses the risk of unintentionally revealing clues about the content of the encryption. In particular, the TLS DEFLATE compression scheme was found to be problematic. Its compression algorithm eliminates duplicate strings."}),"\n",(0,t.jsxs)(s.p,{children:["The CRIME technique was categorized as ",(0,t.jsx)(s.a,{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4929",children:"CVE-2012-4929"})," by MITRE."]}),"\n",(0,t.jsx)(s.h2,{id:"prevent-attacks",children:"Prevent attacks"}),"\n",(0,t.jsx)(s.p,{children:"To prevent the CRIME vulnerability, disable SSL compression."}),"\n",(0,t.jsx)(s.h3,{id:"apache",children:"Apache"}),"\n",(0,t.jsxs)(s.p,{children:["Using the standard settings, CRIME is only a problem for Apache version 2.4.3. To disable SSL compression, define the following directive in your SSL settings (usually ",(0,t.jsx)(s.code,{children:"/etc/apache2/mods-enabled/ssl.con"})," for ",(0,t.jsx)(s.code,{children:"/etc/letsencrypt/options-ssl-apache.conf"})," when using Let's Encrypt). Also, you should strongly think of upgrading Apache to the latest version."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"SSLCompression off\n"})}),"\n",(0,t.jsx)(s.h3,{id:"nginx",children:"Nginx"}),"\n",(0,t.jsx)(s.p,{children:"Nginx is vulnerable to CRIME in older versions, with SSL compression enabled. You must update to a recent version of Nginx and OpenSSL. The following versions are known to prevent vulnerability:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"1.0.9 (if OpenSSL 1.0.0+ used)"}),"\n",(0,t.jsx)(s.li,{children:"1.1.6 (if OpenSSL 1.0.0+ used)"}),"\n",(0,t.jsx)(s.li,{children:"1.2.2"}),"\n",(0,t.jsx)(s.li,{children:"1.3.2"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"apt-get update; apt-get upgrade # Debian / Ubuntu  \nyum update                      # RHeL / CentOS  \npacman -Syu                     # Arch Linux\n"})})]})}function u(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},79920:(e,s,n)=>{n.d(s,{Z:()=>t});const t=n.p+"assets/images/Security_Assessment_PreventSSLCRIME-04bfecd25678979b8a924d88ff25d840.png"},11151:(e,s,n)=>{n.d(s,{Z:()=>o,a:()=>r});var t=n(67294);const i={},a=t.createContext(i);function r(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);